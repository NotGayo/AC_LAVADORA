A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     1


MACRO ASSEMBLER A51 V6.14
OBJECT MODULE PLACED IN .\LAVADORA.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE .\LAVADORA.a SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;====================================VARIABLES=============================================
                             ==============
                       2             
  0020                 3     ESTADO EQU 0x20
  0021                 4     EVENTO EQU 0x21
  0025                 5     DISPLAY_1 EQU 0X25
  0026                 6     DISPLAY_0 EQU 0x26
                       7     
                       8     ;------------------CUENTAS Y VALORES--------------
                       9     
  0022                10     TIEMPO_RESTANTE_MINS EQU 0x22
  0028                11     DECENAS EQU 0x28
  0029                12     UNIDADES EQU 0x29
  002A                13     TEMP_SEL EQU 0x2A
                      14     
  003D                15     PRIMERA_VUELTA EQU 0x27.5
  002B                16     CONT_INTERRUPCIONES_T0 EQU 0x2B
  002C                17     CONT_1S EQU 0x2C
  002D                18     CONT_15S EQU 0x2D
  002E                19     CONT_1MIN EQU 0x2E
  002F                20     CONT_10MIN EQU 0x2F
                      21     
  0030                22     VALOR_ADC EQU 0x30
                      23     ;------------------TICKS--------------
                      24     
  0018                25     TICK_INT_0 EQU 0x23.0
  0019                26     TICK_ADC EQU 0x23.1
  001B                27     TICK_TIMER_0 EQU 0x23.3
  001C                28     TICK_PESADO_OK EQU 0x23.4
  0038                29     TICK_1S EQU 0X27.0
  0039                30     TICK_15S EQU 0x27.1
  003A                31     TICK_1MIN EQU 0x27.2
  003B                32     TICK_50MIN EQU 0X27.3
  003C                33     TICK_10MIN EQU 0X27.4 
                      34     
                      35     ;-----------SENSORES Y ACTIVACIONES-----------------
                      36     
  0087                37     BLOQUEO_PUERTA EQU P0.7
  0090                38     MOTOR_DESAGUE EQU P1.0
  0091                39     PUERTA_ABIERTA EQU P1.1
  0092                40     SENSOR_LLENADO EQU P1.2
  0093                41     SENSOR_VACIADO EQU P1.3
  0094                42     BOTON_INICIO EQU P1.4
  00B1                43     BIT1_TEMP EQU P3.1
  00B0                44     BIT0_TEMP EQU P3.0
  00B3                45     VALV_ENTRADA_AGUA EQU P3.3
  00B6                46     CALENTADOR_AGUA EQU P3.6
  00A7                47     SENTIDO_GIRO_MOTOR EQU P2.7
                      48     
                      49     ;-------------REGISTROS IMPORTANTES-------------------------------
                      50     
  00C5                51     ADCON EQU 0xC5
  00C6                52     ADCH EQU 0xC6
  00FE                53     PWMP EQU 0xFE
  00FC                54     PWM0 EQU 0xFC
                      55     
                      56     ;======================================INCIO===============================================
                             =
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     2

                      57     
0000                  58     ORG 0x0000
0000 017B             59             AJMP INICIO
0003                  60     ORG 0X0003
0003 81FB             61             AJMP INT0_ISR
000B                  62     ORG 0x000B
000B A119             63             AJMP TIMER_0_ISR
0053                  64     ORG 0X0053
0053 A108             65             AJMP ADC_ISR
007B                  66     ORG 0X007b
                      67     
007B                  68     INICIO:
007B 119A             69             ACALL INICIALIZACIONES
                      70     
007D                  71     MAIN:                                   ;LAZO PRINCIPAL
007D 1181             72             ACALL MAQ_ESTADOS
007F 017D             73             AJMP MAIN
                      74     
0081                  75     MAQ_ESTADOS:
0081 E520             76             MOV A, ESTADO
0083 23               77             RL A
0084 900088           78             MOV DPTR, #LISTA_EST
0087 73               79             JMP @A+DPTR
0088                  80     LISTA_EST:
0088 01DF             81             AJMP ESTADO_0 ; REPOSO
008A 01E4             82             AJMP ESTADO_1 ; COMPROBACION SOBREPESO
008C 01E9             83             AJMP ESTADO_2 ; PUERTA ABIERTA
008E 01EE             84             AJMP ESTADO_3 ; LLENANDO
0090 01F3             85             AJMP ESTADO_4 ; CALENTAR CUBA
0092 01F8             86             AJMP ESTADO_5 ; LAVADO
0094 01FD             87             AJMP ESTADO_6 ; VACIAR AGUA
0096 2102             88             AJMP ESTADO_7 ; CENTRIFUGAR
0098 2107             89             AJMP ESTADO_8 ; FIN
                      90     
                      91     ;================================INICIALIZACIONES==========================================
                             ==========================
                      92     
009A                  93     INICIALIZACIONES:
                      94     
009A 752000           95             MOV ESTADO, #0
009D 752100           96             MOV EVENTO, #0
00A0 752505           97             MOV DISPLAY_1, #0x05
00A3 752600           98             MOV DISPLAY_0, #0x00
00A6 75223C           99             MOV TIEMPO_RESTANTE_MINS, #0x3C ;INICIAMOS LOS MINUTOS RESTANTES DE LAVADO A 60h IR
                             EMOS RESTANDO DE UNO EN UNO
00A9 75FE80          100             MOV PWMP, #0x80
00AC C2AF            101             CLR IE.7
00AE D2B2            102             SETB P3.2               ;DESACTIVAMOS A NIVEL BAJO LA INT0
00B0 D2AF            103             SETB IE.7               ;ACTIVAMOS EA* TODAS LAS INTERRUPCIONES
00B2 D2A8            104             SETB IE.0               ;ACTIVAMOS LA INT0      
00B4 C218            105             CLR TICK_INT_0          ;TICK A NIVEL ALTO POR ELLO SE INICIA A 0
00B6 C219            106             CLR TICK_ADC            ;TICK A NIVEL ALTO INICIAMOS A 0
00B8 C238            107             CLR TICK_1S
00BA C239            108             CLR TICK_15S
00BC C23A            109             CLR TICK_1MIN
00BE C23C            110             CLR TICK_10MIN
00C0 C23B            111             CLR TICK_50MIN
00C2 C21C            112             CLR TICK_PESADO_OK
00C4 C23D            113             CLR PRIMERA_VUELTA      
                     114             
                     115             ;ENTRADAS HACEMOS SETB Y ANTES DE LA SIMULACION MARCAMOS EL !! PIN !! AL ESTADO QUE
                              NECESITEMOS INICIAL
00C6 D291            116             SETB P1.1
00C8 D292            117             SETB P1.2
00CA D293            118             SETB P1.3
00CC D294            119             SETB P1.4
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     3

00CE D2B0            120             SETB P3.0
00D0 D2B1            121             SETB P3.1
                     122     
                     123             ;SALIDAS HACEMOS CLR PORQUE NO NOS ENCARGAREMOS MANUALMENTE DE HACER NADA ES EL PRO
                             PIO PROGRAMA EL QUE LOS ACTIVA
00D2 C290            124             CLR P1.0
00D4 C2B3            125             CLR P3.3
00D6 C2B6            126             CLR P3.6
00D8 538000          127             ANL P0, #0x00           ;ASIGNAMOS P0 COMO OUTPUT
00DB 53A000          128             ANL P2, #0x00           ;ASIGNAMOS P2 COMO OUTPUT
                     129     
                     130     
00DE 22              131             RET     
                     132     ;==========================================================================================
                             ===========
                     133     
                     134     ;LLAMAMOS AL GENERADOR DE EVENTOS PARA QUE ASI NOS DIGA A CUAL DEBEMOS IR EN EL ESTADO DEL 
                             SISTEMA QUE NOS ENCONTRAMOS
                     135     
00DF                 136     ESTADO_0:
00DF 5179            137             ACALL GEN_EV_0
00E1 310C            138             ACALL MQ_EVEN_0         ;REPOSO
00E3 22              139             RET
                     140     
00E4                 141     ESTADO_1:
00E4 5193            142             ACALL GEN_EV_1
00E6 313B            143             ACALL MQ_EVEN_1         ;COMPROBANDO SP
00E8 22              144             RET
                     145     
00E9                 146     ESTADO_2:
00E9 51CF            147             ACALL GEN_EV_2
00EB 318B            148             ACALL MQ_EVEN_2
00ED 22              149             RET
                     150     
00EE                 151     ESTADO_3:
00EE 51DA            152             ACALL GEN_EV_3
00F0 31A7            153             ACALL MQ_EVEN_3
00F2 22              154             RET
00F3                 155     ESTADO_4:
00F3 51E5            156             ACALL GEN_EV_4
00F5 31C3            157             ACALL MQ_EVEN_4
00F7 22              158             RET
                     159     
00F8                 160     ESTADO_5:
00F8 711D            161             ACALL GEN_EV_5
00FA 31E0            162             ACALL MQ_EVEN_5
00FC 22              163             RET
                     164     
00FD                 165     ESTADO_6:
00FD 7142            166             ACALL GEN_EV_6
00FF 511A            167             ACALL MQ_EVEN_6
0101 22              168             RET
                     169     
0102                 170     ESTADO_7:
0102 714D            171             ACALL GEN_EV_7
0104 5136            172             ACALL MQ_EVEN_7
0106 22              173             RET
                     174     
0107                 175     ESTADO_8:
0107 7163            176             ACALL GEN_EV_8
0109 515F            177             ACALL MQ_EVEN_8
010B 22              178             RET
                     179     
                     180     
                     181     ;===============================================ESTADO 0 - REPOSO==========================
                             ============================
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     4

010C                 182     MQ_EVEN_0:
                     183     
010C E521            184             MOV A, EVENTO
010E 23              185             RL A
010F 900113          186             MOV DPTR, #LIST_EVEN_MQEV_0
0112 73              187             JMP @A+DPTR
0113                 188     LIST_EVEN_MQEV_0:
0113 2119            189             AJMP ME0_EV_0 ; Evento 0
0115 211D            190             AJMP ME0_EV_1 ; Evento 1
0117 212D            191             AJMP ME0_EV_2 ; Evento 2
0119                 192     ME0_EV_0:
0119 438701          193             ORL PCON, #01H          ;PONEMOS EL IDLE BIT 0 DE PCON NO DEBEMOS ACCEDER EN FORMA 
                             DE BIT HACEMOS UN ORL
011C 22              194             RET
011D                 195     ME0_EV_1:
                     196             ;---    ;ENCENDIO Y PUERTA ABIERTA
011D C2A8            197             CLR IE.0
011F 752677          198             MOV DISPLAY_0, #77H     ;A
0122 752573          199             MOV DISPLAY_1, #73H     ;P
0125 9112            200             ACALL CARGAR_DISPLAY_0
0127 9109            201             ACALL CARGAR_DISPLAY_1  
0129 752002          202             MOV ESTADO, #02H
012C 22              203             RET
012D                 204     ME0_EV_2:
                     205             ;---    ;ENCENDIO Y PUERTA CERRADA
012D C2A8            206             CLR IE.0
012F D2AF            207             SETB IE.7
0131 D2AE            208             SETB IE.6
0133 716E            209             ACALL ACTIVAR_ADC_PESO
0135 C2B2            210             CLR P3.2
0137 752001          211             MOV ESTADO, #01H
013A 22              212             RET
                     213     
                     214     ;===========================================ESTADO 1 - COMPROBANDO SP======================
                             ====================================
013B                 215     MQ_EVEN_1:
013B E521            216             MOV A, EVENTO
013D 23              217             RL A
013E 900142          218             MOV DPTR, #LIST_EVEN_MQEV_1
0141 73              219             JMP @A+DPTR
0142                 220     LIST_EVEN_MQEV_1:
0142 214C            221             AJMP ME1_EV_0 ; Evento 0
0144 214D            222             AJMP ME1_EV_1 ; Se abre la puerta
0146 215D            223             AJMP ME1_EV_2 ; salta adc y sobre peso
0148 216A            224             AJMP ME1_EV_3 ; salta adc, peso ok y p1.4
014A 217F            225             AJMP ME1_EV_4 ; salta adc, peso ok y no p1.4
014C                 226     ME1_EV_0:
014C 22              227             RET
                     228     
014D                 229     ME1_EV_1:       ;PUERTA ABIERTA
014D 717E            230             ACALL APAGAR_ADC
014F 752677          231             MOV DISPLAY_0, #77H     ;A
0152 752573          232             MOV DISPLAY_1, #73H     ;P
0155 752002          233             MOV ESTADO, #02H
0158 9112            234             ACALL CARGAR_DISPLAY_0
015A 9109            235             ACALL CARGAR_DISPLAY_1  
015C 22              236             RET
015D                 237     ME1_EV_2:       ;HAY SOBREPESO
015D 717E            238             ACALL APAGAR_ADC
015F 752673          239             MOV DISPLAY_0, #73H     ;P
0162 75256D          240             MOV DISPLAY_1, #6DH     ;S
0165 9112            241             ACALL CARGAR_DISPLAY_0
0167 9109            242             ACALL CARGAR_DISPLAY_1
0169 22              243             RET
016A                 244     ME1_EV_3:       ;NO SOBREPESO Y ENCENDIDO
016A 717E            245             ACALL APAGAR_ADC
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     5

016C 75253F          246             MOV DISPLAY_1, #3FH     ;t
016F D287            247             SETB BLOQUEO_PUERTA
0171 9137            248             ACALL CARGAR_TEMP_DSP_0 ;Esta subrutina carga en DISPLAY_1 el valor de la temperatu
                             ra actual
0173 9112            249             ACALL CARGAR_DISPLAY_0
0175 9109            250             ACALL CARGAR_DISPLAY_1
0177 D2B3            251             SETB VALV_ENTRADA_AGUA
0179 C294            252             CLR BOTON_INICIO
017B 752003          253             MOV ESTADO, #03H
017E 22              254             RET
                     255     
017F                 256     ME1_EV_4:                       ;NO SOBREPESO Y NO IR A LLENADO, ESPERAMOS POR EL BOTON_INI
                             CIO
017F 717E            257             ACALL APAGAR_ADC
0181 75253F          258             MOV DISPLAY_1, #3FH     ;t
0184 9137            259             ACALL CARGAR_TEMP_DSP_0 ;Esta subrutina carga en DISPLAY_1 el valor de la temperatu
                             ra actual
0186 9112            260             ACALL CARGAR_DISPLAY_0
0188 9109            261             ACALL CARGAR_DISPLAY_1
018A 22              262             RET
                     263     ;==========================================ESTADO 2 - PUERTA ABIERTA=======================
                             ====================================
                     264     
018B                 265     MQ_EVEN_2:
018B E521            266             MOV A, EVENTO
018D 23              267             RL A
018E 900192          268             MOV DPTR, #LIST_EVEN_MQEV_2
0191 73              269             JMP @A+DPTR
0192                 270     LIST_EVEN_MQEV_2:
0192 2196            271             AJMP ME2_EV_0 ; Evento 0
0194 2197            272             AJMP ME2_EV_1 ; Descripci?n Maq. Event. 0. Evento 1
0196                 273     ME2_EV_0:
0196 22              274             RET
0197                 275     ME2_EV_1:       ;PUERTA CERRADA
0197 752001          276             MOV ESTADO, #01H
019A 911B            277             ACALL SET_TEMP_SELECT
019C 716E            278             ACALL ACTIVAR_ADC_PESO
019E D2AF            279             SETB IE.7
01A0 D2AE            280             SETB IE.6
01A2 C219            281             CLR TICK_ADC
01A4 C21C            282             CLR TICK_PESADO_OK
01A6 22              283             RET
                     284     
                     285     ;==========================================ESTADO 3 - LLENADO==============================
                             =============================
                     286     
01A7                 287     MQ_EVEN_3:
01A7 E521            288             MOV A, EVENTO
01A9 23              289             RL A
01AA 9001AE          290             MOV DPTR, #LIST_EVEN_MQEV_3
01AD 73              291             JMP @A+DPTR
01AE                 292     LIST_EVEN_MQEV_3:
01AE 21B2            293             AJMP ME3_EV_0           ; Evento 0
01B0 21B3            294             AJMP ME3_EV_1 
01B2                 295     ME3_EV_0:
01B2 22              296             RET
01B3                 297     ME3_EV_1:                       ;CUBA LLENA
01B3 752004          298             MOV ESTADO, #04H
01B6 D2B6            299             SETB CALENTADOR_AGUA
01B8 7175            300             ACALL ACTIVAR_ADC_TEMP
01BA 7184            301             ACALL ACTIVAR_TIMER_0
01BC C238            302             CLR TICK_1S
01BE C2B3            303             CLR VALV_ENTRADA_AGUA
01C0 911B            304             ACALL SET_TEMP_SELECT
01C2 22              305             RET
                     306     
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     6

                     307     ;==========================================ESTADO 4 - CALENTAMIENTO CUBA===================
                             ========================================
                     308     
01C3                 309     MQ_EVEN_4:
01C3 E521            310             MOV A, EVENTO
01C5 23              311             RL A
01C6 9001CA          312             MOV DPTR, #LIST_EVEN_MQEV_4
01C9 73              313             JMP @A+DPTR
01CA                 314     LIST_EVEN_MQEV_4:
01CA 21D0            315             AJMP ME4_EV_0 ; Evento 0
01CC 21D1            316             AJMP ME4_EV_1
01CE 21D6            317             AJMP ME4_EV_2 
01D0                 318     ME4_EV_0:
01D0 22              319             RET
01D1                 320     ME4_EV_1:       ; NO CALIENTE
01D1 7184            321             ACALL ACTIVAR_TIMER_0
01D3 7175            322             ACALL ACTIVAR_ADC_TEMP
01D5 22              323             RET
01D6                 324     ME4_EV_2:       ; AGUA CALIENTE
01D6 752005          325             MOV ESTADO, #05H
01D9 C2B6            326             CLR CALENTADOR_AGUA
01DB 7184            327             ACALL ACTIVAR_TIMER_0
01DD 71FD            328             ACALL ACTIVAR_PWM0_60RPM
01DF 22              329             RET
                     330     
                     331     ;==========================================ESTADO 5 - LAVADO===============================
                             ============================
                     332     
01E0                 333     MQ_EVEN_5:
01E0 E521            334             MOV A, EVENTO
01E2 23              335             RL A
01E3 9001E7          336             MOV DPTR, #LIST_EVEN_MQEV_5
01E6 73              337             JMP @A+DPTR
01E7                 338     LIST_EVEN_MQEV_5:
01E7 21EF            339             AJMP ME5_EV_0 ; Evento 0
01E9 21F0            340             AJMP ME5_EV_1
01EB 21FB            341             AJMP ME5_EV_2
01ED 4106            342             AJMP ME5_EV_3 
01EF                 343     ME5_EV_0:
01EF 22              344             RET
01F0                 345     ME5_EV_1:       ; PASA 15S
01F0 91EF            346             ACALL CAMBIAR_SENTIDO_GIRO
01F2 7184            347             ACALL ACTIVAR_TIMER_0
01F4 9159            348             ACALL MAPEAR_TIEMPO_D1_D0               ;ACTUALIZAMOS PARA PODER MODIFICAR EL PUERT
                             O 2.7
01F6 9112            349             ACALL CARGAR_DISPLAY_0
01F8 9109            350             ACALL CARGAR_DISPLAY_1
01FA 22              351             RET
01FB                 352     ME5_EV_2:       ; PASAN 1 MIN
01FB 1522            353             DEC TIEMPO_RESTANTE_MINS
01FD 9159            354             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
01FF 9112            355             ACALL CARGAR_DISPLAY_0
0201 9109            356             ACALL CARGAR_DISPLAY_1
0203 7184            357             ACALL ACTIVAR_TIMER_0           ;VOLVEMOS A ACTIVAR LA CUENTA DE 15S
0205 22              358             RET
0206                 359     ME5_EV_3:       ; PASAN 50 MIN
0206 1522            360             DEC TIEMPO_RESTANTE_MINS
0208 9159            361             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
020A 9112            362             ACALL CARGAR_DISPLAY_0
020C 9109            363             ACALL CARGAR_DISPLAY_1
020E 71FC            364             ACALL APAGAR_TIMER
0210 9105            365             ACALL APAGAR_PWM0
0212 752006          366             MOV ESTADO, #06H
0215 D290            367             SETB MOTOR_DESAGUE
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     7

0217 C23D            368             CLR PRIMERA_VUELTA
0219 22              369             RET
                     370     
                     371     ;==========================================ESTADO 6 - VACIAR AGUA==========================
                             =================================
                     372     
021A                 373     MQ_EVEN_6:
021A E521            374             MOV A, EVENTO
021C 23              375             RL A
021D 900221          376             MOV DPTR, #LIST_EVEN_MQEV_6
0220 73              377             JMP @A+DPTR
0221                 378     LIST_EVEN_MQEV_6:
0221 4125            379             AJMP ME6_EV_0 ; Evento 0
0223 4126            380             AJMP ME6_EV_1
0225                 381     ME6_EV_0:
0225 22              382             RET
0226                 383     ME6_EV_1:       ; CUBA VACIA
0226 9101            384             ACALL ACTIVAR_PWM0_600RPM
0228 7184            385             ACALL ACTIVAR_TIMER_0
022A D2A7            386             SETB SENTIDO_GIRO_MOTOR
022C 9159            387             ACALL MAPEAR_TIEMPO_D1_D0
022E 9109            388             ACALL CARGAR_DISPLAY_1
0230 9112            389             ACALL CARGAR_DISPLAY_0
0232 752007          390             MOV ESTADO, #07H
0235 22              391             RET
                     392     
                     393     ;==========================================ESTADO 7 - CENTRIFUGAR==========================
                             =================================
                     394     
0236                 395     MQ_EVEN_7:
0236 E521            396             MOV A, EVENTO
0238 23              397             RL A
0239 90023D          398             MOV DPTR, #LIST_EVEN_MQEV_7
023C 73              399             JMP @A+DPTR
023D                 400     LIST_EVEN_MQEV_7:
023D 4143            401             AJMP ME7_EV_0   ; Evento 0
023F 4144            402             AJMP ME7_EV_1   ; PASAN LOS 10MIN ACABAMOS EL CENTRIF.
0241 4156            403             AJMP ME7_EV_2   ; ACTUALIZAR TIEMPO Y NO 10 MINS DE CENTRIF.
0243                 404     ME7_EV_0:
0243 22              405             RET
0244                 406     ME7_EV_1:       ; PASAN 10 MIN
0244 752008          407             MOV ESTADO, #08H
0247 9105            408             ACALL APAGAR_PWM0
0249 C287            409             CLR BLOQUEO_PUERTA
024B 752538          410             MOV DISPLAY_1, #0x38    ;L
024E 752671          411             MOV DISPLAY_0, #0x71    ;F
0251 9112            412             ACALL CARGAR_DISPLAY_0
0253 9109            413             ACALL CARGAR_DISPLAY_1 
0255 22              414             RET
                     415     
0256                 416     ME7_EV_2:       ; PASA 1 MIN
0256 1522            417             DEC TIEMPO_RESTANTE_MINS
0258 9159            418             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
025A 9112            419             ACALL CARGAR_DISPLAY_0
025C 9109            420             ACALL CARGAR_DISPLAY_1
025E 22              421             RET
                     422     
                     423     ;==========================================ESTADO 8 - FIN==================================
                             =========================
                     424     
025F                 425     MQ_EVEN_8:
025F E521            426             MOV A, EVENTO
0261 23              427             RL A
0262 900266          428             MOV DPTR, #LIST_EVEN_MQEV_8
0265 73              429             JMP @A+DPTR
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     8

0266                 430     LIST_EVEN_MQEV_8:
0266 416A            431             AJMP ME8_EV_0 ; Evento 0
0268 416B            432             AJMP ME8_EV_1
026A                 433     ME8_EV_0:
026A 22              434             RET
026B                 435     ME8_EV_1:                       ; PUERTA ABIERTA
026B 752677          436             MOV DISPLAY_0, #77H     ; A
026E 752573          437             MOV DISPLAY_1, #73H     ; P
0271 752002          438             MOV ESTADO, #02H
0274 9112            439             ACALL CARGAR_DISPLAY_0
0276 9109            440             ACALL CARGAR_DISPLAY_1  
0278 22              441             RET
                     442     
                     443     ;==============================================GENERADORES DE EVENTOS======================
                             =================================
                     444     
                     445     ;-------------------------------------------------------0----------------------------------
                             -------------------------
                     446     
0279                 447     GEN_EV_0:
                     448             ;CONDICIONES ESTADO 0
0279 30B204          449             JNB P3.2, COMPROBAR_PUERTA      ;SI NO ESTA EL BOTON NI NOS MOLESTAMOS EN VER EL RE
                             STO DE CONDICIONES 
027C 752100          450             MOV EVENTO, #00H                ;ESTAMOS SEGURO EN ESTADO 0 SI NO ESTA P3.2
027F 22              451             RET
                     452     
0280                 453     COMPROBAR_PUERTA:
0280 209102          454             JB PUERTA_ABIERTA, GEN_EV_1_ES_0
0283 418C            455             AJMP GEN_EV_2_ES_0
                     456     
0285                 457     GEN_EV_1_ES_0:
0285 5387FE          458             ANL PCON, #0xFE                 ;QUITAMOS EL IDLE MODIFICANDO EL BIT 0 DEL PCON
0288 752101          459             MOV EVENTO, #01H                ;EN EL CASO DE QUE SI ESTE LA PUERTA ABIERTA EVENTO
                              1 ESTADO 0
028B 22              460             RET
                     461     
028C                 462     GEN_EV_2_ES_0:
028C 5387FE          463             ANL PCON, #0xFE                 ;QUITAMOS EL IDLE MODIFICANDO EL BIT 0 DEL PCON
028F 752102          464             MOV EVENTO, #02H                ;EN EL CASO DE QUE SI ESTE LA PUERTA ABIERTA EVENTO
                              2 ESTADO 0
0292 22              465             RET
                     466     
                     467     
                     468     
                     469     ;-------------------------------------------------------1----------------------------------
                             --------------------------
                     470     
0293                 471     GEN_EV_1:
                     472             ;CONDICIONES ESTADO 1                   
0293 209111          473             JB PUERTA_ABIERTA, GEN_EV_1_ES_1        ;SI PUERTA ABIERTA NOS VAMOS A PUERTA ABIER
                             TA
0296 201C07          474             JB TICK_PESADO_OK, COMPROBAR_BTN_INICIO ;SI HEMOS PESADO YA COMPROBAMOS SI HEMOS PU
                             LSADO INICIO
0299 201927          475             JB TICK_ADC, HAY_SP                     ;SI HAY TICK DEL ADC VAMOS A COMPROBAR EL S
                             P
029C 752100          476             MOV EVENTO,#00H
029F 22              477             RET
                     478     
02A0                 479     COMPROBAR_BTN_INICIO:
02A0 209412          480             JB BOTON_INICIO, GEN_EV_3_ES_1
02A3 752100          481             MOV EVENTO,#00H
02A6 22              482             RET
                     483     
02A7                 484     GEN_EV_1_ES_1:                  ;PUERTA ABIERTA
02A7 C219            485             CLR TICK_ADC
02A9 C21C            486             CLR TICK_PESADO_OK
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE     9

02AB 752101          487             MOV EVENTO, #01H
02AE 22              488             RET
02AF                 489     GEN_EV_2_ES_1:                  ;SOBREPESO
02AF C219            490             CLR TICK_ADC
02B1 752102          491             MOV EVENTO, #02H
02B4 22              492             RET
02B5                 493     GEN_EV_3_ES_1:                  ;PESO OK E INICIO AVANZAMOS DE ESTADO
02B5 C219            494             CLR TICK_ADC
02B7 752103          495             MOV EVENTO, #03H
02BA 22              496             RET
02BB                 497     GEN_EV_4_ES_1:                  ;PESO OK NO INICIO NOS QUEDAMOS ESPERANDO A QUE SE PULSE IN
                             ICIO
02BB C219            498             CLR TICK_ADC
02BD D21C            499             SETB TICK_PESADO_OK
02BF 752104          500             MOV EVENTO, #04H
02C2 22              501             RET
                     502     
02C3                 503     HAY_SP:
02C3 E530            504             MOV A, VALOR_ADC
02C5 94E6            505             SUBB A, #0xE6; <-  VALOR SP EQUIVALE A 4.5 VOLTIOS 230d 
02C7 50E6            506             JNC GEN_EV_2_ES_1       ;SI EL RESULTADO ES NEGATIVO (HAY CARRY) VALOR SP > ADCH PE
                             SO OK
02C9 3094EF          507             JNB BOTON_INICIO, GEN_EV_4_ES_1 ;SI NO SI ESTA INICIO PULSADO PASAMOS AL EVENTO 4
02CC 41B5            508             AJMP GEN_EV_3_ES_1
02CE 22              509             RET
                     510             
                     511     ;------------------------------------------------------2-----------------------------------
                             -------------------------
                     512     
02CF                 513     GEN_EV_2:
                     514             ;CONDICIONES ESTADO 0
02CF 309104          515             JNB PUERTA_ABIERTA,  GEN_EV_1_ES_2
02D2 752100          516             MOV EVENTO, #00H
02D5 22              517             RET
                     518     
02D6                 519     GEN_EV_1_ES_2:
02D6 752101          520             MOV EVENTO, #01H
02D9 22              521             RET
                     522     
                     523     
                     524     ;--------------------------------------------------------3---------------------------------
                             -------------------------
                     525     
02DA                 526     GEN_EV_3:
                     527             ;CONDICIONES ESTADO 3
02DA 209204          528             JB SENSOR_LLENADO, GEN_EV_1_ES_3
02DD 752100          529             MOV EVENTO, #00H
02E0 22              530             RET
                     531     
02E1                 532     GEN_EV_1_ES_3:
02E1 752101          533             MOV EVENTO, #01H
02E4 22              534             RET
                     535     
                     536     ;----------------------------------------------------------4-------------------------------
                             -------------------------
                     537     
02E5                 538     GEN_EV_4:
                     539             ;CONDICIONES ESTADO 44
                     540     
02E5 20B005          541             JB P3.0, T_SEL                                  ; P3.1 = 0 Y P3.0 = 0 NI SIQUIERA M
                             EDIMOS DIRECTAMENTE A
02E8 20B102          542             JB P3.1, T_SEL                                  ; TEMPERATURA ALCANZADA
02EB 6115            543             AJMP GEN_EV_2_ES_4
02ED                 544             T_SEL:
02ED 203804          545             JB TICK_1S, COMP_TICK_ADC
02F0 752100          546             MOV EVENTO, #00H
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    10

02F3 22              547             RET
                     548     
02F4                 549     COMP_TICK_ADC:
02F4 201904          550             JB TICK_ADC, COMPROBAR_TEMP
02F7 752100          551             MOV EVENTO, #00H
02FA 22              552             RET
                     553     
02FB                 554     COMPROBAR_TEMP:
02FB 20B106          555             JB P3.1, COMP_T3_T2_T1
02FE 20B003          556             JB P3.0, COMP_T3_T2_T1
0301 6115            557             AJMP GEN_EV_2_ES_4                      ;SI TEMP1 - 0 Y TEMP0 - 0 ENTONCES T0 Y COM
                             O ESTE ESTA OK
0303 22              558             RET
                     559     
0304                 560             COMP_T3_T2_T1:                          ;SOLO SET TEMP_SEL SI T1,T2,T3 YA QUE T0 US
                             A AGUA TAL CUAL
0304 E530            561                     MOV A, VALOR_ADC
0306 952A            562                     SUBB A, TEMP_SEL                ; SUSTITUIR EL VALOR DE 00H POR TEMP MINA A
                             LCANZAR
0308 4003            563                     JC GEN_EV_1_ES_4
030A 6115            564                     AJMP GEN_EV_2_ES_4
030C 22              565                     RET
030D                 566     GEN_EV_1_ES_4:
030D C219            567             CLR TICK_ADC                            ; NO CALIENTE
030F C238            568             CLR TICK_1S
0311 752101          569             MOV EVENTO, #01H
0314 22              570             RET
                     571     
0315                 572     GEN_EV_2_ES_4:  
0315 C219            573             CLR TICK_ADC                            ; SI CALIENTE
0317 C238            574             CLR TICK_1S
0319 752102          575             MOV EVENTO, #02H
031C 22              576             RET
                     577     ;------------------------------------------------------------------------------------------
                             ------------------------
                     578     
031D                 579     GEN_EV_5:
                     580             ;CONDICIONES ESTADO 0
031D 203B16          581             JB TICK_50MIN, GEN_EV_3_ES_5
0320 203A0D          582             JB TICK_1MIN, GEN_EV_2_ES_5
0323 203904          583             JB TICK_15S, GEN_EV_1_ES_5
0326 752100          584             MOV EVENTO, #00H
0329 22              585             RET
                     586     
032A                 587     GEN_EV_1_ES_5:  ;15 SEG
032A C239            588             CLR TICK_15S
032C 752101          589             MOV EVENTO,#01H
032F 22              590             RET
                     591     
0330                 592     GEN_EV_2_ES_5:  ;1MIN
0330 C23A            593             CLR TICK_1MIN
0332 752102          594             MOV EVENTO,#02H
0335 22              595             RET
                     596     
0336                 597     GEN_EV_3_ES_5:  ;50MIN
0336 C23B            598             CLR TICK_50MIN
0338 C23C            599             CLR TICK_10MIN
033A C23A            600             CLR TICK_1MIN
033C C239            601             CLR TICK_15S
033E 752103          602             MOV EVENTO,#03H
0341 22              603             RET
                     604     
                     605     ;------------------------------------------------------------------------------------------
                             ------------------------
                     606     
0342                 607     GEN_EV_6:
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    11

                     608             ;CONDICIONES ESTADO 0
0342 209304          609             JB SENSOR_VACIADO, GEN_EV_1_ES_6
0345 752100          610             MOV EVENTO, #00H
0348 22              611             RET
                     612     
0349                 613     GEN_EV_1_ES_6:
0349 752101          614             MOV EVENTO, #01H
034C 22              615             RET
                     616     ;------------------------------------------------------------------------------------------
                             ------------------------
                     617     
034D                 618     GEN_EV_7:
                     619             ;CONDICIONES ESTADO 7
034D 203C07          620             JB TICK_10MIN, GEN_EV_1_ES_7
0350 203A0A          621             JB TICK_1MIN, GEN_EV_2_ES_7
0353 752100          622             MOV EVENTO, #00H
0356 22              623             RET
                     624     
0357                 625     GEN_EV_1_ES_7:
0357 C23C            626             CLR TICK_10MIN
0359 752101          627             MOV EVENTO, #01H
035C 22              628             RET
                     629     
035D                 630     GEN_EV_2_ES_7:
035D C23A            631             CLR TICK_1MIN
035F 752102          632             MOV EVENTO, #02H
0362 22              633             RET
                     634     ;------------------------------------------------------------------------------------------
                             ------------------------
                     635     
0363                 636     GEN_EV_8:
                     637             ;CONDICIONES ESTADO 0
0363 209104          638             JB PUERTA_ABIERTA, GEN_EV_1_ES_8
0366 752100          639             MOV EVENTO, #00H
0369 22              640             RET
                     641     
036A                 642     GEN_EV_1_ES_8:
036A 752101          643             MOV EVENTO, #01H
036D 22              644             RET
                     645     
                     646     ;------------------------------------------------------------------------------------------
                             ------------------------
                     647     ;================================================ACCIONES==================================
                             =====================
                     648     
036E                 649     ACTIVAR_ADC_PESO:                       ;SELECCIONAMOS EL CANAL 0 PARA PESO
036E 53C5E8          650             ANL ADCON,#0xE8
0371 43C508          651             ORL ADCON,#0x08
0374 22              652             RET
                     653     
0375                 654     ACTIVAR_ADC_TEMP:
0375 D2AE            655             SETB IE.6                               ;SELECCIONAMOS EL CANAL 1 PARA TEMP
0377 53C5E6          656             ANL ADCON, #0xE6
037A 43C509          657             ORL ADCON, #0x09                
037D 22              658             RET
037E                 659     APAGAR_ADC:
037E C2AE            660             CLR IE.6
0380 53C5E0          661             ANL ADCON, #0xE0
0383 22              662             RET
                     663     
                     664     
0384                 665     ACTIVAR_TIMER_0:
0384 303D03          666             JNB PRIMERA_VUELTA, ACTIVAR_TIMER_0_PRIMERA_VUELTA
0387 619C            667             AJMP ACTIVAR_TIMER_0_FULL
0389 22              668             RET
                     669     
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    12

038A                 670     ACTIVAR_TIMER_0_PRIMERA_VUELTA:
038A 758901          671             MOV TMOD, #0x01
038D 758C7B          672             MOV TH0, #0x7B
0390 758A80          673             MOV TL0, #0x80
0393 D2AF            674             SETB IE.7
0395 D2A9            675             SETB IE.1
0397 D23D            676             SETB PRIMERA_VUELTA
0399 D28C            677             SETB TR0
039B 22              678             RET
                     679     
039C                 680     ACTIVAR_TIMER_0_FULL:
039C 758901          681             MOV TMOD, #0x01
039F 758C00          682             MOV TH0, #0x00
03A2 758A00          683             MOV TL0, #0x00
03A5 D2AF            684             SETB IE.7
03A7 D2A9            685             SETB IE.1
03A9 D28C            686             SETB TR0
03AB 22              687             RET
                     688     
03AC                 689     ACTUALIZAR_CONT_TIMER_0:
                     690             
03AC E52B            691             MOV A, CONT_INTERRUPCIONES_T0
03AE 941F            692             SUBB A, #0x1F
03B0 6019            693             JZ PASAN_1SEG
                     694     
03B2 E52C            695             MOV A, CONT_1S
03B4 940E            696             SUBB A, #0x0E
03B6 601F            697             JZ PASAN_15SEG
                     698             
03B8 E52D            699             MOV A, CONT_15S
03BA 9403            700             SUBB A, #0x03
03BC 6023            701             JZ PASAN_1MIN
                     702     
03BE E52E            703             MOV A, CONT_1MIN
03C0 9409            704             SUBB A, #0x09
03C2 6027            705             JZ PASAN_10MIN
                     706             
03C4 E52F            707             MOV A, CONT_10MIN
03C6 9404            708             SUBB A, #0x04
03C8 602B            709             JZ PASAN_50MIN
                     710             
                     711             
03CA 22              712             RET                                             ;escapar del act tiempos
                     713             
03CB                 714             PASAN_1SEG:
03CB 052C            715                     INC CONT_1S
03CD 752B00          716                     MOV CONT_INTERRUPCIONES_T0, #00H
03D0 C23D            717                     CLR PRIMERA_VUELTA                      ;CUANDO SE VUELVA A ACTIVAR T0 LO H
                             ARA DE FORMA
03D2 D238            718                     SETB TICK_1S
03D4 61AC            719                     AJMP ACTUALIZAR_CONT_TIMER_0
03D6 22              720                     RET
03D7                 721             PASAN_15SEG:
03D7 052D            722                     INC CONT_15S
03D9 752C00          723                     MOV CONT_1S, #00H
03DC D239            724                     SETB TICK_15S
03DE 61AC            725                     AJMP ACTUALIZAR_CONT_TIMER_0
03E0 22              726                     RET
03E1                 727             PASAN_1MIN:
03E1 052E            728                     INC CONT_1MIN
03E3 752D00          729                     MOV CONT_15S, #00H
03E6 D23A            730                     SETB TICK_1MIN
03E8 61AC            731                     AJMP ACTUALIZAR_CONT_TIMER_0
03EA 22              732                     RET
03EB                 733             PASAN_10MIN:
03EB 052F            734                     INC CONT_10MIN
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    13

03ED 752E00          735                     MOV CONT_1MIN, #00H
03F0 D23C            736                     SETB TICK_10MIN
03F2 61AC            737                     AJMP ACTUALIZAR_CONT_TIMER_0
03F4 22              738                     RET
03F5                 739             PASAN_50MIN:
03F5 D23B            740                     SETB TICK_50MIN
03F7 752F00          741                     MOV CONT_10MIN, #00H
03FA 22              742                     RET
                     743     
                     744     
                     745     
                     746             ;SI CONT_INT_TO = 31 ENTONCES tick_1s
                     747             ;si tick_1s inc cont 1s
                     748             ;si cont1_1s = 15 ENTONCES tick_15s
                     749             ;si tick 15s inc cont_15s
                     750             ;si cont_15s = 4 entonces tick_1min
                     751             ;si tick_1min inc cont_1min
                     752             ;si cont_1min = 10 ENTONCES tick_10min
                     753             ;si tick_10min inc cont_10min
                     754             ;si cont_10min = 5 ENTONCES tick_50min
                     755     
                     756     
03FB 22              757             RET
03FC                 758     APAGAR_TIMER:
03FC 22              759             RET
                     760     
03FD                 761     ACTIVAR_PWM0_60RPM:
03FD 75FC1A          762             MOV PWM0, #0x1A
0400 22              763             RET
                     764     
0401                 765     ACTIVAR_PWM0_600RPM:
0401 75FCE6          766             MOV PWM0, #0xE6
0404 22              767             RET
                     768     
0405                 769     APAGAR_PWM0:
0405 8500FC          770             MOV PWM0, 0x00
0408 22              771             RET
                     772     
0409                 773     CARGAR_DISPLAY_1:
0409 7480            774             MOV A, #0x80
040B 5280            775             ANL P0, A               ; 1000 0000 -> nos settea todo a 0 menos el .7
040D E525            776             MOV A, DISPLAY_1
040F 4280            777             ORL P0, A               ; dsp1 siempre tiene un 0 en .7 por ello no modifica p0.7
                     778     
0411 22              779             RET
                     780     
0412                 781     CARGAR_DISPLAY_0:
0412 7480            782             MOV A, #0x80
0414 52A0            783             ANL P2, A               ; 1000 0000 -> nos settea todo a 0 menos el .7
0416 E526            784             MOV A, DISPLAY_0
0418 42A0            785             ORL P2, A               ; dsp1 siempre tiene un 0 en .7 por ello no modifica p0.7
041A 22              786             RET
                     787     
                     788     
041B                 789     SET_TEMP_SELECT:
041B 20B103          790             JB P3.1, SET_T_ALTAS
041E 8127            791             AJMP SET_T_BAJAS
0420 22              792             RET
                     793             
0421                 794             SET_T_ALTAS:
0421 20B007          795                     JB P3.0, SET_T_T3
0424 812F            796                     AJMP SET_T_T2
0426 22              797                     RET
0427                 798             SET_T_BAJAS:
0427 20B009          799                     JB P3.0, SET_T_T1
042A 22              800                     RET
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    14

                     801     
042B                 802                     SET_T_T3:
042B 752ACD          803                             MOV TEMP_SEL, #0xCD
042E 22              804                             RET
042F                 805                     SET_T_T2:
042F 752A9A          806                             MOV TEMP_SEL, #0x9A
0432 22              807                             RET
0433                 808                     SET_T_T1:
0433 752A66          809                             MOV TEMP_SEL, #0x66
0436 22              810                             RET
                     811             
0437                 812     CARGAR_TEMP_DSP_0:
0437 30B103          813             JNB BIT1_TEMP, COMPROBAR_B0T_B1_0
043A 8143            814             AJMP COMPROBAR_B0T_B1_1
043C 22              815             RET
                     816     
043D                 817             COMPROBAR_B0T_B1_0:
043D 20B00D          818                     JB BIT0_TEMP, PINTAR_D0_T1
0440 8149            819                     AJMP PINTAR_D0_T0
0442 22              820                     RET
0443                 821             COMPROBAR_B0T_B1_1:
0443 20B00F          822                     JB BIT0_TEMP, PINTAR_D0_T3
0446 8151            823                     AJMP PINTAR_D0_T2
0448 22              824                     RET
                     825             
0449                 826             PINTAR_D0_T0:
0449 75263F          827                     MOV DISPLAY_0, #0x3F    ;0
044C 22              828                     RET
044D                 829             PINTAR_D0_T1:
044D 752606          830                     MOV DISPLAY_0, #0x06    ;1
0450 22              831                     RET
0451                 832             PINTAR_D0_T2:
0451 75265B          833                     MOV DISPLAY_0, #0x5B    ;2
0454 22              834                     RET
0455                 835             PINTAR_D0_T3:
0455 75264F          836                     MOV DISPLAY_0, #0x4F    ;3
0458 22              837                     RET
                     838     
0459                 839     MAPEAR_TIEMPO_D1_D0:                    ;guardamos los valores de t restante por decenas y 
                             unidades en dos dir.
0459 E522            840             MOV A,TIEMPO_RESTANTE_MINS
045B 75F00A          841             MOV B, #0AH
045E 84              842             DIV AB                          ; APROVECHAMOS QUE ADCH/10 COCIENTE -> A (decenas) 
                             Y RESTO -> B (unidades)
045F F528            843             MOV DECENAS, A
0461 85F029          844             MOV UNIDADES, B
                     845             
0464 9169            846             ACALL MAP_DEC_D1
0466 91AC            847             ACALL MAP_UNI_D0
                     848     
0468 22              849             RET
                     850     
0469                 851             MAP_DEC_D1:
0469 E528            852                     MOV A, DECENAS
046B 23              853                     RL A
046C 900470          854                     MOV DPTR, #LISTA_DECENAS
046F 73              855                     JMP @A+DPTR
0470                 856             LISTA_DECENAS:
0470 8184            857                     AJMP CD0
0472 8188            858                     AJMP CD1
0474 818C            859                     AJMP CD2
0476 8190            860                     AJMP CD3
0478 8194            861                     AJMP CD4
047A 8198            862                     AJMP CD5
047C 819C            863                     AJMP CD6
047E 81A0            864                     AJMP CD7
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    15

0480 81A4            865                     AJMP CD8
0482 81A8            866                     AJMP CD9
                     867             
0484                 868             CD0:
0484 75253F          869                     MOV DISPLAY_1, #0x3F
0487 22              870                     RET
0488                 871             CD1:
0488 752506          872                     MOV DISPLAY_1, #0x06
048B 22              873                     RET
048C                 874             CD2:
048C 75255B          875                     MOV DISPLAY_1, #0x5B
048F 22              876                     RET
0490                 877             CD3:
0490 75254F          878                     MOV DISPLAY_1, #0x4F
0493 22              879                     RET
0494                 880             CD4:
0494 752566          881                     MOV DISPLAY_1, #0x66
0497 22              882                     RET
0498                 883             CD5:
0498 75256D          884                     MOV DISPLAY_1, #0x6D
049B 22              885                     RET
049C                 886             CD6:
049C 75257D          887                     MOV DISPLAY_1, #0x7D
049F 22              888                     RET
04A0                 889             CD7:
04A0 752507          890                     MOV DISPLAY_1, #0x07
04A3 22              891                     RET
04A4                 892             CD8:
04A4 75257F          893                     MOV DISPLAY_1, #0x7F
04A7 22              894                     RET
04A8                 895             CD9:
04A8 75256F          896                     MOV DISPLAY_1, #0x6F
04AB 22              897                     RET
                     898     
04AC                 899             MAP_UNI_D0:
04AC E529            900                     MOV A, UNIDADES
04AE 23              901                     RL A
04AF 9004B3          902                     MOV DPTR, #LISTA_UNIDADES
04B2 73              903                     JMP @A+DPTR
04B3                 904             LISTA_UNIDADES:
04B3 81C7            905                     AJMP CU0
04B5 81CB            906                     AJMP CU1
04B7 81CF            907                     AJMP CU2
04B9 81D3            908                     AJMP CU3
04BB 81D7            909                     AJMP CU4
04BD 81DB            910                     AJMP CU5
04BF 81DF            911                     AJMP CU6
04C1 81E3            912                     AJMP CU7
04C3 81E7            913                     AJMP CU8
04C5 81EB            914                     AJMP CU9
                     915             
04C7                 916             CU0:
04C7 75263F          917                     MOV DISPLAY_0, #0x3F
04CA 22              918                     RET
04CB                 919             CU1:
04CB 752606          920                     MOV DISPLAY_0, #0x06
04CE 22              921                     RET
04CF                 922             CU2:
04CF 75265B          923                     MOV DISPLAY_0, #0x5B
04D2 22              924                     RET
04D3                 925             CU3:
04D3 75264F          926                     MOV DISPLAY_0, #0x4F
04D6 22              927                     RET
04D7                 928             CU4:
04D7 752666          929                     MOV DISPLAY_0, #0x66
04DA 22              930                     RET
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    16

04DB                 931             CU5:
04DB 75266D          932                     MOV DISPLAY_0, #0x6D
04DE 22              933                     RET
04DF                 934             CU6:
04DF 75267D          935                     MOV DISPLAY_0, #0x7D
04E2 22              936                     RET
04E3                 937             CU7:
04E3 752607          938                     MOV DISPLAY_0, #0x07
04E6 22              939                     RET
04E7                 940             CU8:
04E7 75267F          941                     MOV DISPLAY_0, #0x7F
04EA 22              942                     RET
04EB                 943             CU9:
04EB 75266F          944                     MOV DISPLAY_0, #0x6F
04EE 22              945                     RET
                     946     
04EF                 947     CAMBIAR_SENTIDO_GIRO:
04EF 20A703          948             JB SENTIDO_GIRO_MOTOR, FALSE_SG                 ;SI SENT 1 -> VAMOS A SET0
04F2 81F8            949             AJMP TRUE_SG                                    ;SI SENT 0 -> SET1
04F4 22              950             RET
04F5                 951             FALSE_SG:
04F5 C2A7            952                     CLR SENTIDO_GIRO_MOTOR
04F7 22              953                     RET
04F8                 954             TRUE_SG:
04F8 D2A7            955                     SETB SENTIDO_GIRO_MOTOR
04FA 22              956                     RET
                     957     ;==============================================INTERRUPCIONES==============================
                             =========================
                     958     
04FB                 959     INT0_ISR:
04FB C0E0            960             PUSH ACC
04FD C0D0            961             PUSH PSW
04FF D218            962             SETB TICK_INT_0
0501 C2A8            963             CLR IE.0
0503 D0D0            964             POP PSW
0505 D0E0            965             POP ACC
0507 32              966             RETI
                     967     
0508                 968     ADC_ISR:
0508 C0E0            969             PUSH ACC
050A C0D0            970             PUSH PSW
050C D219            971             SETB TICK_ADC
050E 85C630          972             MOV VALOR_ADC, ADCH
0511 53C5E1          973             ANL ADCON, #0xE1                ;PARAS EL ADC
0514 D0D0            974             POP PSW
0516 D0E0            975             POP ACC
0518 32              976             RETI
                     977     
0519                 978     TIMER_0_ISR:
0519 C0E0            979             PUSH ACC
051B C0D0            980             PUSH PSW
051D 052B            981             INC CONT_INTERRUPCIONES_T0
051F 71AC            982             ACALL ACTUALIZAR_CONT_TIMER_0
0521 7184            983             ACALL ACTIVAR_TIMER_0
0523 D0D0            984             POP PSW
0525 D0E0            985             POP ACC
0527 32              986             RETI
                     987     
                     988     ;==============================================FIN=========================================
                             =============
                     989     
                     990     END
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    17

SYMBOL TABLE LISTING
------ ----- -------


N A M E                         T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACTIVAR_ADC_PESO . . . . . . .  C ADDR   036EH   A   
ACTIVAR_ADC_TEMP . . . . . . .  C ADDR   0375H   A   
ACTIVAR_PWM0_600RPM. . . . . .  C ADDR   0401H   A   
ACTIVAR_PWM0_60RPM . . . . . .  C ADDR   03FDH   A   
ACTIVAR_TIMER_0. . . . . . . .  C ADDR   0384H   A   
ACTIVAR_TIMER_0_FULL . . . . .  C ADDR   039CH   A   
ACTIVAR_TIMER_0_PRIMERA_VUELTA  C ADDR   038AH   A   
ACTUALIZAR_CONT_TIMER_0. . . .  C ADDR   03ACH   A   
ADCH . . . . . . . . . . . . .  N NUMB   00C6H   A   
ADCON. . . . . . . . . . . . .  N NUMB   00C5H   A   
ADC_ISR. . . . . . . . . . . .  C ADDR   0508H   A   
APAGAR_ADC . . . . . . . . . .  C ADDR   037EH   A   
APAGAR_PWM0. . . . . . . . . .  C ADDR   0405H   A   
APAGAR_TIMER . . . . . . . . .  C ADDR   03FCH   A   
B. . . . . . . . . . . . . . .  D ADDR   00F0H   A   
BIT0_TEMP. . . . . . . . . . .  B ADDR   00B0H.0 A   
BIT1_TEMP. . . . . . . . . . .  B ADDR   00B0H.1 A   
BLOQUEO_PUERTA . . . . . . . .  B ADDR   0080H.7 A   
BOTON_INICIO . . . . . . . . .  B ADDR   0090H.4 A   
CALENTADOR_AGUA. . . . . . . .  B ADDR   00B0H.6 A   
CAMBIAR_SENTIDO_GIRO . . . . .  C ADDR   04EFH   A   
CARGAR_DISPLAY_0 . . . . . . .  C ADDR   0412H   A   
CARGAR_DISPLAY_1 . . . . . . .  C ADDR   0409H   A   
CARGAR_TEMP_DSP_0. . . . . . .  C ADDR   0437H   A   
CD0. . . . . . . . . . . . . .  C ADDR   0484H   A   
CD1. . . . . . . . . . . . . .  C ADDR   0488H   A   
CD2. . . . . . . . . . . . . .  C ADDR   048CH   A   
CD3. . . . . . . . . . . . . .  C ADDR   0490H   A   
CD4. . . . . . . . . . . . . .  C ADDR   0494H   A   
CD5. . . . . . . . . . . . . .  C ADDR   0498H   A   
CD6. . . . . . . . . . . . . .  C ADDR   049CH   A   
CD7. . . . . . . . . . . . . .  C ADDR   04A0H   A   
CD8. . . . . . . . . . . . . .  C ADDR   04A4H   A   
CD9. . . . . . . . . . . . . .  C ADDR   04A8H   A   
COMPROBAR_B0T_B1_0 . . . . . .  C ADDR   043DH   A   
COMPROBAR_B0T_B1_1 . . . . . .  C ADDR   0443H   A   
COMPROBAR_BTN_INICIO . . . . .  C ADDR   02A0H   A   
COMPROBAR_PUERTA . . . . . . .  C ADDR   0280H   A   
COMPROBAR_TEMP . . . . . . . .  C ADDR   02FBH   A   
COMP_T3_T2_T1. . . . . . . . .  C ADDR   0304H   A   
COMP_TICK_ADC. . . . . . . . .  C ADDR   02F4H   A   
CONT_10MIN . . . . . . . . . .  N NUMB   002FH   A   
CONT_15S . . . . . . . . . . .  N NUMB   002DH   A   
CONT_1MIN. . . . . . . . . . .  N NUMB   002EH   A   
CONT_1S. . . . . . . . . . . .  N NUMB   002CH   A   
CONT_INTERRUPCIONES_T0 . . . .  N NUMB   002BH   A   
CU0. . . . . . . . . . . . . .  C ADDR   04C7H   A   
CU1. . . . . . . . . . . . . .  C ADDR   04CBH   A   
CU2. . . . . . . . . . . . . .  C ADDR   04CFH   A   
CU3. . . . . . . . . . . . . .  C ADDR   04D3H   A   
CU4. . . . . . . . . . . . . .  C ADDR   04D7H   A   
CU5. . . . . . . . . . . . . .  C ADDR   04DBH   A   
CU6. . . . . . . . . . . . . .  C ADDR   04DFH   A   
CU7. . . . . . . . . . . . . .  C ADDR   04E3H   A   
CU8. . . . . . . . . . . . . .  C ADDR   04E7H   A   
CU9. . . . . . . . . . . . . .  C ADDR   04EBH   A   
DECENAS. . . . . . . . . . . .  N NUMB   0028H   A   
DISPLAY_0. . . . . . . . . . .  N NUMB   0026H   A   
DISPLAY_1. . . . . . . . . . .  N NUMB   0025H   A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    18

ESTADO . . . . . . . . . . . .  N NUMB   0020H   A   
ESTADO_0 . . . . . . . . . . .  C ADDR   00DFH   A   
ESTADO_1 . . . . . . . . . . .  C ADDR   00E4H   A   
ESTADO_2 . . . . . . . . . . .  C ADDR   00E9H   A   
ESTADO_3 . . . . . . . . . . .  C ADDR   00EEH   A   
ESTADO_4 . . . . . . . . . . .  C ADDR   00F3H   A   
ESTADO_5 . . . . . . . . . . .  C ADDR   00F8H   A   
ESTADO_6 . . . . . . . . . . .  C ADDR   00FDH   A   
ESTADO_7 . . . . . . . . . . .  C ADDR   0102H   A   
ESTADO_8 . . . . . . . . . . .  C ADDR   0107H   A   
EVENTO . . . . . . . . . . . .  N NUMB   0021H   A   
FALSE_SG . . . . . . . . . . .  C ADDR   04F5H   A   
GEN_EV_0 . . . . . . . . . . .  C ADDR   0279H   A   
GEN_EV_1 . . . . . . . . . . .  C ADDR   0293H   A   
GEN_EV_1_ES_0. . . . . . . . .  C ADDR   0285H   A   
GEN_EV_1_ES_1. . . . . . . . .  C ADDR   02A7H   A   
GEN_EV_1_ES_2. . . . . . . . .  C ADDR   02D6H   A   
GEN_EV_1_ES_3. . . . . . . . .  C ADDR   02E1H   A   
GEN_EV_1_ES_4. . . . . . . . .  C ADDR   030DH   A   
GEN_EV_1_ES_5. . . . . . . . .  C ADDR   032AH   A   
GEN_EV_1_ES_6. . . . . . . . .  C ADDR   0349H   A   
GEN_EV_1_ES_7. . . . . . . . .  C ADDR   0357H   A   
GEN_EV_1_ES_8. . . . . . . . .  C ADDR   036AH   A   
GEN_EV_2 . . . . . . . . . . .  C ADDR   02CFH   A   
GEN_EV_2_ES_0. . . . . . . . .  C ADDR   028CH   A   
GEN_EV_2_ES_1. . . . . . . . .  C ADDR   02AFH   A   
GEN_EV_2_ES_4. . . . . . . . .  C ADDR   0315H   A   
GEN_EV_2_ES_5. . . . . . . . .  C ADDR   0330H   A   
GEN_EV_2_ES_7. . . . . . . . .  C ADDR   035DH   A   
GEN_EV_3 . . . . . . . . . . .  C ADDR   02DAH   A   
GEN_EV_3_ES_1. . . . . . . . .  C ADDR   02B5H   A   
GEN_EV_3_ES_5. . . . . . . . .  C ADDR   0336H   A   
GEN_EV_4 . . . . . . . . . . .  C ADDR   02E5H   A   
GEN_EV_4_ES_1. . . . . . . . .  C ADDR   02BBH   A   
GEN_EV_5 . . . . . . . . . . .  C ADDR   031DH   A   
GEN_EV_6 . . . . . . . . . . .  C ADDR   0342H   A   
GEN_EV_7 . . . . . . . . . . .  C ADDR   034DH   A   
GEN_EV_8 . . . . . . . . . . .  C ADDR   0363H   A   
HAY_SP . . . . . . . . . . . .  C ADDR   02C3H   A   
IE . . . . . . . . . . . . . .  D ADDR   00A8H   A   
INICIALIZACIONES . . . . . . .  C ADDR   009AH   A   
INICIO . . . . . . . . . . . .  C ADDR   007BH   A   
INT0_ISR . . . . . . . . . . .  C ADDR   04FBH   A   
LISTA_DECENAS. . . . . . . . .  C ADDR   0470H   A   
LISTA_EST. . . . . . . . . . .  C ADDR   0088H   A   
LISTA_UNIDADES . . . . . . . .  C ADDR   04B3H   A   
LIST_EVEN_MQEV_0 . . . . . . .  C ADDR   0113H   A   
LIST_EVEN_MQEV_1 . . . . . . .  C ADDR   0142H   A   
LIST_EVEN_MQEV_2 . . . . . . .  C ADDR   0192H   A   
LIST_EVEN_MQEV_3 . . . . . . .  C ADDR   01AEH   A   
LIST_EVEN_MQEV_4 . . . . . . .  C ADDR   01CAH   A   
LIST_EVEN_MQEV_5 . . . . . . .  C ADDR   01E7H   A   
LIST_EVEN_MQEV_6 . . . . . . .  C ADDR   0221H   A   
LIST_EVEN_MQEV_7 . . . . . . .  C ADDR   023DH   A   
LIST_EVEN_MQEV_8 . . . . . . .  C ADDR   0266H   A   
MAIN . . . . . . . . . . . . .  C ADDR   007DH   A   
MAPEAR_TIEMPO_D1_D0. . . . . .  C ADDR   0459H   A   
MAP_DEC_D1 . . . . . . . . . .  C ADDR   0469H   A   
MAP_UNI_D0 . . . . . . . . . .  C ADDR   04ACH   A   
MAQ_ESTADOS. . . . . . . . . .  C ADDR   0081H   A   
ME0_EV_0 . . . . . . . . . . .  C ADDR   0119H   A   
ME0_EV_1 . . . . . . . . . . .  C ADDR   011DH   A   
ME0_EV_2 . . . . . . . . . . .  C ADDR   012DH   A   
ME1_EV_0 . . . . . . . . . . .  C ADDR   014CH   A   
ME1_EV_1 . . . . . . . . . . .  C ADDR   014DH   A   
ME1_EV_2 . . . . . . . . . . .  C ADDR   015DH   A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    19

ME1_EV_3 . . . . . . . . . . .  C ADDR   016AH   A   
ME1_EV_4 . . . . . . . . . . .  C ADDR   017FH   A   
ME2_EV_0 . . . . . . . . . . .  C ADDR   0196H   A   
ME2_EV_1 . . . . . . . . . . .  C ADDR   0197H   A   
ME3_EV_0 . . . . . . . . . . .  C ADDR   01B2H   A   
ME3_EV_1 . . . . . . . . . . .  C ADDR   01B3H   A   
ME4_EV_0 . . . . . . . . . . .  C ADDR   01D0H   A   
ME4_EV_1 . . . . . . . . . . .  C ADDR   01D1H   A   
ME4_EV_2 . . . . . . . . . . .  C ADDR   01D6H   A   
ME5_EV_0 . . . . . . . . . . .  C ADDR   01EFH   A   
ME5_EV_1 . . . . . . . . . . .  C ADDR   01F0H   A   
ME5_EV_2 . . . . . . . . . . .  C ADDR   01FBH   A   
ME5_EV_3 . . . . . . . . . . .  C ADDR   0206H   A   
ME6_EV_0 . . . . . . . . . . .  C ADDR   0225H   A   
ME6_EV_1 . . . . . . . . . . .  C ADDR   0226H   A   
ME7_EV_0 . . . . . . . . . . .  C ADDR   0243H   A   
ME7_EV_1 . . . . . . . . . . .  C ADDR   0244H   A   
ME7_EV_2 . . . . . . . . . . .  C ADDR   0256H   A   
ME8_EV_0 . . . . . . . . . . .  C ADDR   026AH   A   
ME8_EV_1 . . . . . . . . . . .  C ADDR   026BH   A   
MOTOR_DESAGUE. . . . . . . . .  B ADDR   0090H.0 A   
MQ_EVEN_0. . . . . . . . . . .  C ADDR   010CH   A   
MQ_EVEN_1. . . . . . . . . . .  C ADDR   013BH   A   
MQ_EVEN_2. . . . . . . . . . .  C ADDR   018BH   A   
MQ_EVEN_3. . . . . . . . . . .  C ADDR   01A7H   A   
MQ_EVEN_4. . . . . . . . . . .  C ADDR   01C3H   A   
MQ_EVEN_5. . . . . . . . . . .  C ADDR   01E0H   A   
MQ_EVEN_6. . . . . . . . . . .  C ADDR   021AH   A   
MQ_EVEN_7. . . . . . . . . . .  C ADDR   0236H   A   
MQ_EVEN_8. . . . . . . . . . .  C ADDR   025FH   A   
P0 . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PASAN_10MIN. . . . . . . . . .  C ADDR   03EBH   A   
PASAN_15SEG. . . . . . . . . .  C ADDR   03D7H   A   
PASAN_1MIN . . . . . . . . . .  C ADDR   03E1H   A   
PASAN_1SEG . . . . . . . . . .  C ADDR   03CBH   A   
PASAN_50MIN. . . . . . . . . .  C ADDR   03F5H   A   
PCON . . . . . . . . . . . . .  D ADDR   0087H   A   
PINTAR_D0_T0 . . . . . . . . .  C ADDR   0449H   A   
PINTAR_D0_T1 . . . . . . . . .  C ADDR   044DH   A   
PINTAR_D0_T2 . . . . . . . . .  C ADDR   0451H   A   
PINTAR_D0_T3 . . . . . . . . .  C ADDR   0455H   A   
PRIMERA_VUELTA . . . . . . . .  B ADDR   0027H.5 A   
PSW. . . . . . . . . . . . . .  D ADDR   00D0H   A   
PUERTA_ABIERTA . . . . . . . .  B ADDR   0090H.1 A   
PWM0 . . . . . . . . . . . . .  N NUMB   00FCH   A   
PWMP . . . . . . . . . . . . .  N NUMB   00FEH   A   
SENSOR_LLENADO . . . . . . . .  B ADDR   0090H.2 A   
SENSOR_VACIADO . . . . . . . .  B ADDR   0090H.3 A   
SENTIDO_GIRO_MOTOR . . . . . .  B ADDR   00A0H.7 A   
SET_TEMP_SELECT. . . . . . . .  C ADDR   041BH   A   
SET_T_ALTAS. . . . . . . . . .  C ADDR   0421H   A   
SET_T_BAJAS. . . . . . . . . .  C ADDR   0427H   A   
SET_T_T1 . . . . . . . . . . .  C ADDR   0433H   A   
SET_T_T2 . . . . . . . . . . .  C ADDR   042FH   A   
SET_T_T3 . . . . . . . . . . .  C ADDR   042BH   A   
TEMP_SEL . . . . . . . . . . .  N NUMB   002AH   A   
TH0. . . . . . . . . . . . . .  D ADDR   008CH   A   
TICK_10MIN . . . . . . . . . .  B ADDR   0027H.4 A   
TICK_15S . . . . . . . . . . .  B ADDR   0027H.1 A   
TICK_1MIN. . . . . . . . . . .  B ADDR   0027H.2 A   
TICK_1S. . . . . . . . . . . .  B ADDR   0027H.0 A   
TICK_50MIN . . . . . . . . . .  B ADDR   0027H.3 A   
TICK_ADC . . . . . . . . . . .  B ADDR   0023H.1 A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/25/2025 14:04:19 PAGE    20

TICK_INT_0 . . . . . . . . . .  B ADDR   0023H.0 A   
TICK_PESADO_OK . . . . . . . .  B ADDR   0023H.4 A   
TICK_TIMER_0 . . . . . . . . .  B ADDR   0023H.3 A   
TIEMPO_RESTANTE_MINS . . . . .  N NUMB   0022H   A   
TIMER_0_ISR. . . . . . . . . .  C ADDR   0519H   A   
TL0. . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRUE_SG. . . . . . . . . . . .  C ADDR   04F8H   A   
T_SEL. . . . . . . . . . . . .  C ADDR   02EDH   A   
UNIDADES . . . . . . . . . . .  N NUMB   0029H   A   
VALOR_ADC. . . . . . . . . . .  N NUMB   0030H   A   
VALV_ENTRADA_AGUA. . . . . . .  B ADDR   00B0H.3 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
