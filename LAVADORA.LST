A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     1


MACRO ASSEMBLER A51 V6.14
OBJECT MODULE PLACED IN .\LAVADORA.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE .\LAVADORA.a SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;====================================VARIABLES=============================================
                             ==============
                       2             
  0020                 3     ESTADO EQU 0x20
  0021                 4     EVENTO EQU 0x21
  0025                 5     DISPLAY_1 EQU 0X25
  0026                 6     DISPLAY_0 EQU 0x26
                       7     
                       8     ;------------------CUENTAS Y VALORES--------------
                       9     
  0022                10     TIEMPO_RESTANTE_MINS EQU 0x22
  0028                11     DECENAS EQU 0x28
  0029                12     UNIDADES EQU 0x29
  002A                13     TEMP_SEL EQU 0x2A
                      14     
  003D                15     PRIMERA_VUELTA EQU 0x27.5
  002B                16     CONT_INTERRUPCIONES_T0 EQU 0x2B
  002C                17     CONT_1S EQU 0x2C
  002D                18     CONT_15S EQU 0x2D
  002E                19     CONT_1MIN EQU 0x2E
  002F                20     CONT_10MIN EQU 0x2F
                      21     
  0030                22     VALOR_ADC EQU 0x30
                      23     ;------------------TICKS--------------
                      24     
  0018                25     TICK_INT_0 EQU 0x23.0
  0019                26     TICK_ADC EQU 0x23.1
  001B                27     TICK_TIMER_0 EQU 0x23.3
  001C                28     TICK_PESADO_OK EQU 0x23.4
  0038                29     TICK_1S EQU 0X27.0
  0039                30     TICK_15S EQU 0x27.1
  003A                31     TICK_1MIN EQU 0x27.2
  003B                32     TICK_50MIN EQU 0X27.3
  003C                33     TICK_10MIN EQU 0X27.4 
                      34     
                      35     ;-----------SENSORES Y ACTIVACIONES-----------------
                      36     
  0087                37     BLOQUEO_PUERTA EQU P0.7
  0090                38     MOTOR_DESAGUE EQU P1.0
  0091                39     PUERTA_ABIERTA EQU P1.1
  0092                40     SENSOR_LLENADO EQU P1.2
  0093                41     SENSOR_VACIADO EQU P1.3
  0094                42     BOTON_INICIO EQU P1.4
  00B1                43     BIT1_TEMP EQU P3.1
  00B0                44     BIT0_TEMP EQU P3.0
  00B3                45     VALV_ENTRADA_AGUA EQU P3.3
  00B6                46     CALENTADOR_AGUA EQU P3.6
  00A7                47     SENTIDO_GIRO_MOTOR EQU P2.7
                      48     
                      49     ;-------------REGISTROS IMPORTANTES-------------------------------
                      50     
  00C5                51     ADCON EQU 0xC5
  00C6                52     ADCH EQU 0xC6
  00FE                53     PWMP EQU 0xFE
  00FC                54     PWM0 EQU 0xFC
                      55     
                      56     ;======================================INCIO===============================================
                             =
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     2

                      57     
0000                  58     ORG 0x0000
0000 017B             59             AJMP INICIO
0003                  60     ORG 0X0003
0003 A10F             61             AJMP INT0_ISR
000B                  62     ORG 0x000B
000B A12D             63             AJMP TIMER_0_ISR
0053                  64     ORG 0X0053
0053 A11C             65             AJMP ADC_ISR
007B                  66     ORG 0X007b
                      67     
007B                  68     INICIO:
007B 119A             69             ACALL INICIALIZACIONES
                      70     
007D                  71     MAIN:                                   ;LAZO PRINCIPAL
007D 1181             72             ACALL MAQ_ESTADOS
007F 017D             73             AJMP MAIN
                      74     
0081                  75     MAQ_ESTADOS:
0081 E520             76             MOV A, ESTADO
0083 23               77             RL A
0084 900088           78             MOV DPTR, #LISTA_EST
0087 73               79             JMP @A+DPTR
0088                  80     LISTA_EST:
0088 01EB             81             AJMP ESTADO_0 ; REPOSO
008A 01F0             82             AJMP ESTADO_1 ; COMPROBACION SOBREPESO
008C 01F5             83             AJMP ESTADO_2 ; PUERTA ABIERTA
008E 01FA             84             AJMP ESTADO_3 ; LLENANDO
0090 01FF             85             AJMP ESTADO_4 ; CALENTAR CUBA
0092 2104             86             AJMP ESTADO_5 ; LAVADO
0094 2109             87             AJMP ESTADO_6 ; VACIAR AGUA
0096 210E             88             AJMP ESTADO_7 ; CENTRIFUGAR
0098 2113             89             AJMP ESTADO_8 ; FIN
                      90     
                      91     ;================================INICIALIZACIONES==========================================
                             ==========================
                      92     
009A                  93     INICIALIZACIONES:
                      94     
009A 752000           95             MOV ESTADO, #0
009D 752100           96             MOV EVENTO, #0
00A0 752505           97             MOV DISPLAY_1, #0x05
00A3 752600           98             MOV DISPLAY_0, #0x00
00A6 75223C           99             MOV TIEMPO_RESTANTE_MINS, #0x3C ;INICIAMOS LOS MINUTOS RESTANTES DE LAVADO A 60h IR
                             EMOS RESTANDO DE UNO EN UNO
00A9 75FE80          100             MOV PWMP, #0x80
00AC C2AF            101             CLR IE.7
00AE D2B2            102             SETB P3.2               ;DESACTIVAMOS A NIVEL BAJO LA INT0
00B0 D2AF            103             SETB IE.7               ;ACTIVAMOS EA* TODAS LAS INTERRUPCIONES
00B2 D2A8            104             SETB IE.0               ;ACTIVAMOS LA INT0      
00B4 C218            105             CLR TICK_INT_0          ;TICK A NIVEL ALTO POR ELLO SE INICIA A 0
00B6 C219            106             CLR TICK_ADC            ;TICK A NIVEL ALTO INICIAMOS A 0
00B8 C238            107             CLR TICK_1S
00BA C239            108             CLR TICK_15S
00BC C23A            109             CLR TICK_1MIN
00BE C23C            110             CLR TICK_10MIN
00C0 C23B            111             CLR TICK_50MIN
00C2 C21C            112             CLR TICK_PESADO_OK
00C4 C23D            113             CLR PRIMERA_VUELTA      
                     114             
                     115             ;ENTRADAS HACEMOS SETB Y ANTES DE LA SIMULACION MARCAMOS EL !! PIN !! AL ESTADO QUE
                              NECESITEMOS INICIAL
00C6 D291            116             SETB P1.1
00C8 D292            117             SETB P1.2
00CA D293            118             SETB P1.3
00CC D294            119             SETB P1.4
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     3

00CE D2B0            120             SETB P3.0
00D0 D2B1            121             SETB P3.1
                     122     
                     123             ;SALIDAS HACEMOS CLR PORQUE NO NOS ENCARGAREMOS MANUALMENTE DE HACER NADA ES EL PRO
                             PIO PROGRAMA EL QUE LOS ACTIVA
00D2 C290            124             CLR P1.0
00D4 C2B3            125             CLR P3.3
00D6 C2B6            126             CLR P3.6
00D8 538000          127             ANL P0, #0x00           ;ASIGNAMOS P0 COMO OUTPUT
00DB 53A000          128             ANL P2, #0x00           ;ASIGNAMOS P2 COMO OUTPUT
                     129                     
00DE C295            130             CLR P1.5
00E0 C296            131             CLR P1.6
00E2 C297            132             CLR P1.7
00E4 C2B4            133             CLR P3.4
00E6 C2B5            134             CLR P3.5
00E8 C2B7            135             CLR P3.7
                     136     
00EA 22              137             RET     
                     138     ;==========================================================================================
                             ===========
                     139     
                     140     ;LLAMAMOS AL GENERADOR DE EVENTOS PARA QUE ASI NOS DIGA A CUAL DEBEMOS IR EN EL ESTADO DEL 
                             SISTEMA QUE NOS ENCONTRAMOS
                     141     
00EB                 142     ESTADO_0:
00EB 518D            143             ACALL GEN_EV_0
00ED 3118            144             ACALL MQ_EVEN_0         ;REPOSO
00EF 22              145             RET
                     146     
00F0                 147     ESTADO_1:
00F0 51A7            148             ACALL GEN_EV_1
00F2 3147            149             ACALL MQ_EVEN_1         ;COMPROBANDO SP
00F4 22              150             RET
                     151     
00F5                 152     ESTADO_2:
00F5 51E3            153             ACALL GEN_EV_2
00F7 3197            154             ACALL MQ_EVEN_2
00F9 22              155             RET
                     156     
00FA                 157     ESTADO_3:
00FA 51EE            158             ACALL GEN_EV_3
00FC 31B3            159             ACALL MQ_EVEN_3
00FE 22              160             RET
00FF                 161     ESTADO_4:
00FF 51F9            162             ACALL GEN_EV_4
0101 31CF            163             ACALL MQ_EVEN_4
0103 22              164             RET
                     165     
0104                 166     ESTADO_5:
0104 7131            167             ACALL GEN_EV_5
0106 31F0            168             ACALL MQ_EVEN_5
0108 22              169             RET
                     170     
0109                 171     ESTADO_6:
0109 7156            172             ACALL GEN_EV_6
010B 512E            173             ACALL MQ_EVEN_6
010D 22              174             RET
                     175     
010E                 176     ESTADO_7:
010E 7161            177             ACALL GEN_EV_7
0110 514A            178             ACALL MQ_EVEN_7
0112 22              179             RET
                     180     
0113                 181     ESTADO_8:
0113 7177            182             ACALL GEN_EV_8
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     4

0115 5173            183             ACALL MQ_EVEN_8
0117 22              184             RET
                     185     
                     186     
                     187     ;===============================================ESTADO 0 - REPOSO==========================
                             ============================
0118                 188     MQ_EVEN_0:
                     189     
0118 E521            190             MOV A, EVENTO
011A 23              191             RL A
011B 90011F          192             MOV DPTR, #LIST_EVEN_MQEV_0
011E 73              193             JMP @A+DPTR
011F                 194     LIST_EVEN_MQEV_0:
011F 2125            195             AJMP ME0_EV_0 ; Evento 0
0121 2129            196             AJMP ME0_EV_1 ; Evento 1
0123 2139            197             AJMP ME0_EV_2 ; Evento 2
0125                 198     ME0_EV_0:
0125 438701          199             ORL PCON, #01H          ;PONEMOS EL IDLE BIT 0 DE PCON NO DEBEMOS ACCEDER EN FORMA 
                             DE BIT HACEMOS UN ORL
0128 22              200             RET
0129                 201     ME0_EV_1:
                     202             ;---    ;ENCENDIO Y PUERTA ABIERTA
0129 C2A8            203             CLR IE.0
012B 752677          204             MOV DISPLAY_0, #77H     ;A
012E 752573          205             MOV DISPLAY_1, #73H     ;P
0131 9126            206             ACALL CARGAR_DISPLAY_0
0133 911D            207             ACALL CARGAR_DISPLAY_1  
0135 752002          208             MOV ESTADO, #02H
0138 22              209             RET
0139                 210     ME0_EV_2:
                     211             ;---    ;ENCENDIO Y PUERTA CERRADA
0139 C2A8            212             CLR IE.0
013B D2AF            213             SETB IE.7
013D D2AE            214             SETB IE.6
013F 7182            215             ACALL ACTIVAR_ADC_PESO
0141 C2B2            216             CLR P3.2
0143 752001          217             MOV ESTADO, #01H
0146 22              218             RET
                     219     
                     220     ;===========================================ESTADO 1 - COMPROBANDO SP======================
                             ====================================
0147                 221     MQ_EVEN_1:
0147 E521            222             MOV A, EVENTO
0149 23              223             RL A
014A 90014E          224             MOV DPTR, #LIST_EVEN_MQEV_1
014D 73              225             JMP @A+DPTR
014E                 226     LIST_EVEN_MQEV_1:
014E 2158            227             AJMP ME1_EV_0 ; Evento 0
0150 2159            228             AJMP ME1_EV_1 ; Se abre la puerta
0152 2169            229             AJMP ME1_EV_2 ; salta adc y sobre peso
0154 2176            230             AJMP ME1_EV_3 ; salta adc, peso ok y p1.4
0156 218B            231             AJMP ME1_EV_4 ; salta adc, peso ok y no p1.4
0158                 232     ME1_EV_0:
0158 22              233             RET
                     234     
0159                 235     ME1_EV_1:       ;PUERTA ABIERTA
0159 7192            236             ACALL APAGAR_ADC
015B 752677          237             MOV DISPLAY_0, #77H     ;A
015E 752573          238             MOV DISPLAY_1, #73H     ;P
0161 752002          239             MOV ESTADO, #02H
0164 9126            240             ACALL CARGAR_DISPLAY_0
0166 911D            241             ACALL CARGAR_DISPLAY_1  
0168 22              242             RET
0169                 243     ME1_EV_2:       ;HAY SOBREPESO
0169 7192            244             ACALL APAGAR_ADC
016B 752673          245             MOV DISPLAY_0, #73H     ;P
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     5

016E 75256D          246             MOV DISPLAY_1, #6DH     ;S
0171 9126            247             ACALL CARGAR_DISPLAY_0
0173 911D            248             ACALL CARGAR_DISPLAY_1
0175 22              249             RET
0176                 250     ME1_EV_3:       ;NO SOBREPESO Y ENCENDIDO
0176 7192            251             ACALL APAGAR_ADC
0178 752578          252             MOV DISPLAY_1, #78H     ;t
017B D287            253             SETB BLOQUEO_PUERTA
017D 914B            254             ACALL CARGAR_TEMP_DSP_0 ;Esta subrutina carga en DISPLAY_1 el valor de la temperatu
                             ra actual
017F 9126            255             ACALL CARGAR_DISPLAY_0
0181 911D            256             ACALL CARGAR_DISPLAY_1
0183 D2B3            257             SETB VALV_ENTRADA_AGUA
0185 C294            258             CLR BOTON_INICIO
0187 752003          259             MOV ESTADO, #03H
018A 22              260             RET
                     261     
018B                 262     ME1_EV_4:                       ;NO SOBREPESO Y NO IR A LLENADO, ESPERAMOS POR EL BOTON_INI
                             CIO
018B 7192            263             ACALL APAGAR_ADC
018D 752578          264             MOV DISPLAY_1, #78H     ;t
0190 914B            265             ACALL CARGAR_TEMP_DSP_0 ;Esta subrutina carga en DISPLAY_0 el valor de la temperatu
                             ra actual
0192 9126            266             ACALL CARGAR_DISPLAY_0
0194 911D            267             ACALL CARGAR_DISPLAY_1
0196 22              268             RET
                     269     ;==========================================ESTADO 2 - PUERTA ABIERTA=======================
                             ====================================
                     270     
0197                 271     MQ_EVEN_2:
0197 E521            272             MOV A, EVENTO
0199 23              273             RL A
019A 90019E          274             MOV DPTR, #LIST_EVEN_MQEV_2
019D 73              275             JMP @A+DPTR
019E                 276     LIST_EVEN_MQEV_2:
019E 21A2            277             AJMP ME2_EV_0 ; Evento 0
01A0 21A3            278             AJMP ME2_EV_1 ; Descripci?n Maq. Event. 0. Evento 1
01A2                 279     ME2_EV_0:
01A2 22              280             RET
01A3                 281     ME2_EV_1:       ;PUERTA CERRADA
01A3 752001          282             MOV ESTADO, #01H
01A6 912F            283             ACALL SET_TEMP_SELECT
01A8 7182            284             ACALL ACTIVAR_ADC_PESO
01AA D2AF            285             SETB IE.7
01AC D2AE            286             SETB IE.6
01AE C219            287             CLR TICK_ADC
01B0 C21C            288             CLR TICK_PESADO_OK
01B2 22              289             RET
                     290     
                     291     ;==========================================ESTADO 3 - LLENADO==============================
                             =============================
                     292     
01B3                 293     MQ_EVEN_3:
01B3 E521            294             MOV A, EVENTO
01B5 23              295             RL A
01B6 9001BA          296             MOV DPTR, #LIST_EVEN_MQEV_3
01B9 73              297             JMP @A+DPTR
01BA                 298     LIST_EVEN_MQEV_3:
01BA 21BE            299             AJMP ME3_EV_0           ; Evento 0
01BC 21BF            300             AJMP ME3_EV_1 
01BE                 301     ME3_EV_0:
01BE 22              302             RET
01BF                 303     ME3_EV_1:                       ;CUBA LLENA
01BF 752004          304             MOV ESTADO, #04H
01C2 D2B6            305             SETB CALENTADOR_AGUA
01C4 7189            306             ACALL ACTIVAR_ADC_TEMP
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     6

01C6 7198            307             ACALL ACTIVAR_TIMER_0
01C8 C238            308             CLR TICK_1S
01CA C2B3            309             CLR VALV_ENTRADA_AGUA
01CC 912F            310             ACALL SET_TEMP_SELECT
01CE 22              311             RET
                     312     
                     313     ;==========================================ESTADO 4 - CALENTAMIENTO CUBA===================
                             ========================================
                     314     
01CF                 315     MQ_EVEN_4:
01CF E521            316             MOV A, EVENTO
01D1 23              317             RL A
01D2 9001D6          318             MOV DPTR, #LIST_EVEN_MQEV_4
01D5 73              319             JMP @A+DPTR
01D6                 320     LIST_EVEN_MQEV_4:
01D6 21DC            321             AJMP ME4_EV_0 ; Evento 0
01D8 21DD            322             AJMP ME4_EV_1
01DA 21E4            323             AJMP ME4_EV_2 
01DC                 324     ME4_EV_0:
01DC 22              325             RET
01DD                 326     ME4_EV_1:       ; NO CALIENTE
01DD C23D            327             CLR PRIMERA_VUELTA
01DF 7198            328             ACALL ACTIVAR_TIMER_0
01E1 7189            329             ACALL ACTIVAR_ADC_TEMP
01E3 22              330             RET
01E4                 331     ME4_EV_2:       ; AGUA CALIENTE
01E4 752005          332             MOV ESTADO, #05H
01E7 C2B6            333             CLR CALENTADOR_AGUA
01E9 C23D            334             CLR PRIMERA_VUELTA
01EB 7198            335             ACALL ACTIVAR_TIMER_0
01ED 9111            336             ACALL ACTIVAR_PWM0_60RPM
01EF 22              337             RET
                     338     
                     339     ;==========================================ESTADO 5 - LAVADO===============================
                             ============================
                     340     
01F0                 341     MQ_EVEN_5:
01F0 E521            342             MOV A, EVENTO
01F2 23              343             RL A
01F3 9001F7          344             MOV DPTR, #LIST_EVEN_MQEV_5
01F6 73              345             JMP @A+DPTR
01F7                 346     LIST_EVEN_MQEV_5:
01F7 21FF            347             AJMP ME5_EV_0 ; Evento 0
01F9 4100            348             AJMP ME5_EV_1
01FB 410D            349             AJMP ME5_EV_2
01FD 411A            350             AJMP ME5_EV_3 
01FF                 351     ME5_EV_0:
01FF 22              352             RET
0200                 353     ME5_EV_1:       ; PASA 15S
0200 B103            354             ACALL CAMBIAR_SENTIDO_GIRO
0202 C23D            355             CLR PRIMERA_VUELTA
0204 7198            356             ACALL ACTIVAR_TIMER_0
0206 916D            357             ACALL MAPEAR_TIEMPO_D1_D0               ;ACTUALIZAMOS PARA PODER MODIFICAR EL PUERT
                             O 2.7
0208 9126            358             ACALL CARGAR_DISPLAY_0
020A 911D            359             ACALL CARGAR_DISPLAY_1
020C 22              360             RET
020D                 361     ME5_EV_2:       ; PASAN 1 MIN
020D 1522            362             DEC TIEMPO_RESTANTE_MINS
020F 916D            363             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
0211 9126            364             ACALL CARGAR_DISPLAY_0
0213 911D            365             ACALL CARGAR_DISPLAY_1
0215 C23D            366             CLR PRIMERA_VUELTA
0217 7198            367             ACALL ACTIVAR_TIMER_0           ;VOLVEMOS A ACTIVAR LA CUENTA DE 15S
0219 22              368             RET
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     7

021A                 369     ME5_EV_3:       ; PASAN 50 MIN
021A 1522            370             DEC TIEMPO_RESTANTE_MINS
021C 916D            371             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
021E 9126            372             ACALL CARGAR_DISPLAY_0
0220 911D            373             ACALL CARGAR_DISPLAY_1
0222 9110            374             ACALL APAGAR_TIMER
0224 9119            375             ACALL APAGAR_PWM0
0226 752006          376             MOV ESTADO, #06H
0229 D290            377             SETB MOTOR_DESAGUE
022B C23D            378             CLR PRIMERA_VUELTA
022D 22              379             RET
                     380     
                     381     ;==========================================ESTADO 6 - VACIAR AGUA==========================
                             =================================
                     382     
022E                 383     MQ_EVEN_6:
022E E521            384             MOV A, EVENTO
0230 23              385             RL A
0231 900235          386             MOV DPTR, #LIST_EVEN_MQEV_6
0234 73              387             JMP @A+DPTR
0235                 388     LIST_EVEN_MQEV_6:
0235 4139            389             AJMP ME6_EV_0 ; Evento 0
0237 413A            390             AJMP ME6_EV_1
0239                 391     ME6_EV_0:
0239 22              392             RET
023A                 393     ME6_EV_1:       ; CUBA VACIA
023A 9115            394             ACALL ACTIVAR_PWM0_600RPM
023C 7198            395             ACALL ACTIVAR_TIMER_0
023E D2A7            396             SETB SENTIDO_GIRO_MOTOR
0240 916D            397             ACALL MAPEAR_TIEMPO_D1_D0
0242 911D            398             ACALL CARGAR_DISPLAY_1
0244 9126            399             ACALL CARGAR_DISPLAY_0
0246 752007          400             MOV ESTADO, #07H
0249 22              401             RET
                     402     
                     403     ;==========================================ESTADO 7 - CENTRIFUGAR==========================
                             =================================
                     404     
024A                 405     MQ_EVEN_7:
024A E521            406             MOV A, EVENTO
024C 23              407             RL A
024D 900251          408             MOV DPTR, #LIST_EVEN_MQEV_7
0250 73              409             JMP @A+DPTR
0251                 410     LIST_EVEN_MQEV_7:
0251 4157            411             AJMP ME7_EV_0   ; Evento 0
0253 4158            412             AJMP ME7_EV_1   ; PASAN LOS 10MIN ACABAMOS EL CENTRIF.
0255 416A            413             AJMP ME7_EV_2   ; ACTUALIZAR TIEMPO Y NO 10 MINS DE CENTRIF.
0257                 414     ME7_EV_0:
0257 22              415             RET
0258                 416     ME7_EV_1:       ; PASAN 10 MIN
0258 752008          417             MOV ESTADO, #08H
025B 9119            418             ACALL APAGAR_PWM0
025D C287            419             CLR BLOQUEO_PUERTA
025F 752538          420             MOV DISPLAY_1, #0x38    ;L
0262 752671          421             MOV DISPLAY_0, #0x71    ;F
0265 9126            422             ACALL CARGAR_DISPLAY_0
0267 911D            423             ACALL CARGAR_DISPLAY_1 
0269 22              424             RET
                     425     
026A                 426     ME7_EV_2:       ; PASA 1 MIN
026A 1522            427             DEC TIEMPO_RESTANTE_MINS
026C 916D            428             ACALL MAPEAR_TIEMPO_D1_D0               ;GUARDA EN DSP1 Y DSP0 LOS VALORES DEL TIEM
                             PO
026E 9126            429             ACALL CARGAR_DISPLAY_0
0270 911D            430             ACALL CARGAR_DISPLAY_1
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     8

0272 22              431             RET
                     432     
                     433     ;==========================================ESTADO 8 - FIN==================================
                             =========================
                     434     
0273                 435     MQ_EVEN_8:
0273 E521            436             MOV A, EVENTO
0275 23              437             RL A
0276 90027A          438             MOV DPTR, #LIST_EVEN_MQEV_8
0279 73              439             JMP @A+DPTR
027A                 440     LIST_EVEN_MQEV_8:
027A 417E            441             AJMP ME8_EV_0 ; Evento 0
027C 417F            442             AJMP ME8_EV_1
027E                 443     ME8_EV_0:
027E 22              444             RET
027F                 445     ME8_EV_1:                       ; PUERTA ABIERTA
027F 752677          446             MOV DISPLAY_0, #77H     ; A
0282 752573          447             MOV DISPLAY_1, #73H     ; P
0285 752002          448             MOV ESTADO, #02H
0288 9126            449             ACALL CARGAR_DISPLAY_0
028A 911D            450             ACALL CARGAR_DISPLAY_1  
028C 22              451             RET
                     452     
                     453     ;==============================================GENERADORES DE EVENTOS======================
                             =================================
                     454     
                     455     ;-------------------------------------------------------0----------------------------------
                             -------------------------
                     456     
028D                 457     GEN_EV_0:
                     458             ;CONDICIONES ESTADO 0
028D 30B204          459             JNB P3.2, COMPROBAR_PUERTA      ;SI NO ESTA EL BOTON NI NOS MOLESTAMOS EN VER EL RE
                             STO DE CONDICIONES 
0290 752100          460             MOV EVENTO, #00H                ;ESTAMOS SEGURO EN ESTADO 0 SI NO ESTA P3.2
0293 22              461             RET
                     462     
0294                 463     COMPROBAR_PUERTA:
0294 209102          464             JB PUERTA_ABIERTA, GEN_EV_1_ES_0
0297 41A0            465             AJMP GEN_EV_2_ES_0
                     466     
0299                 467     GEN_EV_1_ES_0:
0299 5387FE          468             ANL PCON, #0xFE                 ;QUITAMOS EL IDLE MODIFICANDO EL BIT 0 DEL PCON
029C 752101          469             MOV EVENTO, #01H                ;EN EL CASO DE QUE SI ESTE LA PUERTA ABIERTA EVENTO
                              1 ESTADO 0
029F 22              470             RET
                     471     
02A0                 472     GEN_EV_2_ES_0:
02A0 5387FE          473             ANL PCON, #0xFE                 ;QUITAMOS EL IDLE MODIFICANDO EL BIT 0 DEL PCON
02A3 752102          474             MOV EVENTO, #02H                ;EN EL CASO DE QUE SI ESTE LA PUERTA ABIERTA EVENTO
                              2 ESTADO 0
02A6 22              475             RET
                     476     
                     477     
                     478     
                     479     ;-------------------------------------------------------1----------------------------------
                             --------------------------
                     480     
02A7                 481     GEN_EV_1:
                     482             ;CONDICIONES ESTADO 1                   
02A7 209111          483             JB PUERTA_ABIERTA, GEN_EV_1_ES_1        ;SI PUERTA ABIERTA NOS VAMOS A PUERTA ABIER
                             TA
02AA 201C07          484             JB TICK_PESADO_OK, COMPROBAR_BTN_INICIO ;SI HEMOS PESADO YA COMPROBAMOS SI HEMOS PU
                             LSADO INICIO
02AD 201927          485             JB TICK_ADC, HAY_SP                     ;SI HAY TICK DEL ADC VAMOS A COMPROBAR EL S
                             P
02B0 752100          486             MOV EVENTO,#00H
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE     9

02B3 22              487             RET
                     488     
02B4                 489     COMPROBAR_BTN_INICIO:
02B4 209412          490             JB BOTON_INICIO, GEN_EV_3_ES_1
02B7 752100          491             MOV EVENTO,#00H
02BA 22              492             RET
                     493     
02BB                 494     GEN_EV_1_ES_1:                  ;PUERTA ABIERTA
02BB C219            495             CLR TICK_ADC
02BD C21C            496             CLR TICK_PESADO_OK
02BF 752101          497             MOV EVENTO, #01H
02C2 22              498             RET
02C3                 499     GEN_EV_2_ES_1:                  ;SOBREPESO
02C3 C219            500             CLR TICK_ADC
02C5 752102          501             MOV EVENTO, #02H
02C8 22              502             RET
02C9                 503     GEN_EV_3_ES_1:                  ;PESO OK E INICIO AVANZAMOS DE ESTADO
02C9 C219            504             CLR TICK_ADC
02CB 752103          505             MOV EVENTO, #03H
02CE 22              506             RET
02CF                 507     GEN_EV_4_ES_1:                  ;PESO OK NO INICIO NOS QUEDAMOS ESPERANDO A QUE SE PULSE IN
                             ICIO
02CF C219            508             CLR TICK_ADC
02D1 D21C            509             SETB TICK_PESADO_OK
02D3 752104          510             MOV EVENTO, #04H
02D6 22              511             RET
                     512     
02D7                 513     HAY_SP:
02D7 E530            514             MOV A, VALOR_ADC
02D9 94E6            515             SUBB A, #0xE6; <-  VALOR SP EQUIVALE A 4.5 VOLTIOS 230d 
02DB 50E6            516             JNC GEN_EV_2_ES_1       ;SI EL RESULTADO ES NEGATIVO (HAY CARRY) VALOR SP > ADCH PE
                             SO OK
02DD 3094EF          517             JNB BOTON_INICIO, GEN_EV_4_ES_1 ;SI NO SI ESTA INICIO PULSADO PASAMOS AL EVENTO 4
02E0 41C9            518             AJMP GEN_EV_3_ES_1
02E2 22              519             RET
                     520             
                     521     ;------------------------------------------------------2-----------------------------------
                             -------------------------
                     522     
02E3                 523     GEN_EV_2:
                     524             ;CONDICIONES ESTADO 0
02E3 309104          525             JNB PUERTA_ABIERTA,  GEN_EV_1_ES_2
02E6 752100          526             MOV EVENTO, #00H
02E9 22              527             RET
                     528     
02EA                 529     GEN_EV_1_ES_2:
02EA 752101          530             MOV EVENTO, #01H
02ED 22              531             RET
                     532     
                     533     
                     534     ;--------------------------------------------------------3---------------------------------
                             -------------------------
                     535     
02EE                 536     GEN_EV_3:
                     537             ;CONDICIONES ESTADO 3
02EE 209204          538             JB SENSOR_LLENADO, GEN_EV_1_ES_3
02F1 752100          539             MOV EVENTO, #00H
02F4 22              540             RET
                     541     
02F5                 542     GEN_EV_1_ES_3:
02F5 752101          543             MOV EVENTO, #01H
02F8 22              544             RET
                     545     
                     546     ;----------------------------------------------------------4-------------------------------
                             -------------------------
                     547     
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    10

02F9                 548     GEN_EV_4:
                     549             ;CONDICIONES ESTADO 44
                     550     
02F9 20B005          551             JB P3.0, T_SEL                                  ; P3.1 = 0 Y P3.0 = 0 NI SIQUIERA M
                             EDIMOS DIRECTAMENTE A
02FC 20B102          552             JB P3.1, T_SEL                                  ; TEMPERATURA ALCANZADA
02FF 6129            553             AJMP GEN_EV_2_ES_4
0301                 554             T_SEL:
0301 203804          555             JB TICK_1S, COMP_TICK_ADC
0304 752100          556             MOV EVENTO, #00H
0307 22              557             RET
                     558     
0308                 559     COMP_TICK_ADC:
0308 201904          560             JB TICK_ADC, COMPROBAR_TEMP
030B 752100          561             MOV EVENTO, #00H
030E 22              562             RET
                     563     
030F                 564     COMPROBAR_TEMP:
030F 20B106          565             JB P3.1, COMP_T3_T2_T1
0312 20B003          566             JB P3.0, COMP_T3_T2_T1
0315 6129            567             AJMP GEN_EV_2_ES_4                      ;SI TEMP1 - 0 Y TEMP0 - 0 ENTONCES T0 Y COM
                             O ESTE ESTA OK
0317 22              568             RET
                     569     
0318                 570             COMP_T3_T2_T1:                          ;SOLO SET TEMP_SEL SI T1,T2,T3 YA QUE T0 US
                             A AGUA TAL CUAL
0318 E530            571                     MOV A, VALOR_ADC
031A 952A            572                     SUBB A, TEMP_SEL                ; SUSTITUIR EL VALOR DE 00H POR TEMP MINA A
                             LCANZAR
031C 4003            573                     JC GEN_EV_1_ES_4
031E 6129            574                     AJMP GEN_EV_2_ES_4
0320 22              575                     RET
0321                 576     GEN_EV_1_ES_4:
0321 C219            577             CLR TICK_ADC                            ; NO CALIENTE
0323 C238            578             CLR TICK_1S
0325 752101          579             MOV EVENTO, #01H
0328 22              580             RET
                     581     
0329                 582     GEN_EV_2_ES_4:  
0329 C219            583             CLR TICK_ADC                            ; SI CALIENTE
032B C238            584             CLR TICK_1S
032D 752102          585             MOV EVENTO, #02H
0330 22              586             RET
                     587     ;------------------------------------------------------------------------------------------
                             ------------------------
                     588     
0331                 589     GEN_EV_5:
                     590             ;CONDICIONES ESTADO 0
0331 203B16          591             JB TICK_50MIN, GEN_EV_3_ES_5
0334 203A0D          592             JB TICK_1MIN, GEN_EV_2_ES_5
0337 203904          593             JB TICK_15S, GEN_EV_1_ES_5
033A 752100          594             MOV EVENTO, #00H
033D 22              595             RET
                     596     
033E                 597     GEN_EV_1_ES_5:  ;15 SEG
033E C239            598             CLR TICK_15S
0340 752101          599             MOV EVENTO,#01H
0343 22              600             RET
                     601     
0344                 602     GEN_EV_2_ES_5:  ;1MIN
0344 C23A            603             CLR TICK_1MIN
0346 752102          604             MOV EVENTO,#02H
0349 22              605             RET
                     606     
034A                 607     GEN_EV_3_ES_5:  ;50MIN
034A C23B            608             CLR TICK_50MIN
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    11

034C C23C            609             CLR TICK_10MIN
034E C23A            610             CLR TICK_1MIN
0350 C239            611             CLR TICK_15S
0352 752103          612             MOV EVENTO,#03H
0355 22              613             RET
                     614     
                     615     ;------------------------------------------------------------------------------------------
                             ------------------------
                     616     
0356                 617     GEN_EV_6:
                     618             ;CONDICIONES ESTADO 0
0356 209304          619             JB SENSOR_VACIADO, GEN_EV_1_ES_6
0359 752100          620             MOV EVENTO, #00H
035C 22              621             RET
                     622     
035D                 623     GEN_EV_1_ES_6:
035D 752101          624             MOV EVENTO, #01H
0360 22              625             RET
                     626     ;------------------------------------------------------------------------------------------
                             ------------------------
                     627     
0361                 628     GEN_EV_7:
                     629             ;CONDICIONES ESTADO 7
0361 203C07          630             JB TICK_10MIN, GEN_EV_1_ES_7
0364 203A0A          631             JB TICK_1MIN, GEN_EV_2_ES_7
0367 752100          632             MOV EVENTO, #00H
036A 22              633             RET
                     634     
036B                 635     GEN_EV_1_ES_7:
036B C23C            636             CLR TICK_10MIN
036D 752101          637             MOV EVENTO, #01H
0370 22              638             RET
                     639     
0371                 640     GEN_EV_2_ES_7:
0371 C23A            641             CLR TICK_1MIN
0373 752102          642             MOV EVENTO, #02H
0376 22              643             RET
                     644     ;------------------------------------------------------------------------------------------
                             ------------------------
                     645     
0377                 646     GEN_EV_8:
                     647             ;CONDICIONES ESTADO 0
0377 209104          648             JB PUERTA_ABIERTA, GEN_EV_1_ES_8
037A 752100          649             MOV EVENTO, #00H
037D 22              650             RET
                     651     
037E                 652     GEN_EV_1_ES_8:
037E 752101          653             MOV EVENTO, #01H
0381 22              654             RET
                     655     
                     656     ;------------------------------------------------------------------------------------------
                             ------------------------
                     657     ;================================================ACCIONES==================================
                             =====================
                     658     
0382                 659     ACTIVAR_ADC_PESO:                       ;SELECCIONAMOS EL CANAL 0 PARA PESO
0382 53C5E8          660             ANL ADCON,#0xE8
0385 43C508          661             ORL ADCON,#0x08
0388 22              662             RET
                     663     
0389                 664     ACTIVAR_ADC_TEMP:
0389 D2AE            665             SETB IE.6                               ;SELECCIONAMOS EL CANAL 1 PARA TEMP
038B 53C5E6          666             ANL ADCON, #0xE6
038E 43C509          667             ORL ADCON, #0x09                
0391 22              668             RET
0392                 669     APAGAR_ADC:
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    12

0392 C2AE            670             CLR IE.6
0394 53C5E0          671             ANL ADCON, #0xE0
0397 22              672             RET
                     673     
                     674     
0398                 675     ACTIVAR_TIMER_0:
0398 303D03          676             JNB PRIMERA_VUELTA, ACTIVAR_TIMER_0_PRIMERA_VUELTA
039B 61B0            677             AJMP ACTIVAR_TIMER_0_FULL
039D 22              678             RET
                     679     
039E                 680     ACTIVAR_TIMER_0_PRIMERA_VUELTA:
039E 758901          681             MOV TMOD, #0x01
03A1 758C7B          682             MOV TH0, #0x7B
03A4 758A80          683             MOV TL0, #0x80
03A7 D2AF            684             SETB IE.7
03A9 D2A9            685             SETB IE.1
03AB D23D            686             SETB PRIMERA_VUELTA
03AD D28C            687             SETB TR0
03AF 22              688             RET
                     689     
03B0                 690     ACTIVAR_TIMER_0_FULL:
03B0 758901          691             MOV TMOD, #0x01
03B3 758C00          692             MOV TH0, #0x00
03B6 758A00          693             MOV TL0, #0x00
03B9 D2AF            694             SETB IE.7
03BB D2A9            695             SETB IE.1
03BD D28C            696             SETB TR0
03BF 22              697             RET
                     698     
03C0                 699     ACTUALIZAR_CONT_TIMER_0:
                     700             
03C0 E52B            701             MOV A, CONT_INTERRUPCIONES_T0
03C2 941F            702             SUBB A, #0x1F
03C4 6019            703             JZ PASAN_1SEG
                     704     
03C6 E52C            705             MOV A, CONT_1S
03C8 940E            706             SUBB A, #0x0E
03CA 601F            707             JZ PASAN_15SEG
                     708             
03CC E52D            709             MOV A, CONT_15S
03CE 9403            710             SUBB A, #0x03
03D0 6023            711             JZ PASAN_1MIN
                     712     
03D2 E52E            713             MOV A, CONT_1MIN
03D4 9409            714             SUBB A, #0x09
03D6 6027            715             JZ PASAN_10MIN
                     716             
03D8 E52F            717             MOV A, CONT_10MIN
03DA 9404            718             SUBB A, #0x04
03DC 602B            719             JZ PASAN_50MIN
                     720             
                     721             
03DE 22              722             RET                                             ;escapar del act tiempos
                     723             
03DF                 724             PASAN_1SEG:
03DF 052C            725                     INC CONT_1S
03E1 752B00          726                     MOV CONT_INTERRUPCIONES_T0, #00H
03E4 C23D            727                     CLR PRIMERA_VUELTA                      ;CUANDO SE VUELVA A ACTIVAR T0 LO H
                             ARA DE FORMA
03E6 D238            728                     SETB TICK_1S
03E8 61C0            729                     AJMP ACTUALIZAR_CONT_TIMER_0
03EA 22              730                     RET
03EB                 731             PASAN_15SEG:
03EB 052D            732                     INC CONT_15S
03ED 752C00          733                     MOV CONT_1S, #00H
03F0 D239            734                     SETB TICK_15S
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    13

03F2 61C0            735                     AJMP ACTUALIZAR_CONT_TIMER_0
03F4 22              736                     RET
03F5                 737             PASAN_1MIN:
03F5 052E            738                     INC CONT_1MIN
03F7 752D00          739                     MOV CONT_15S, #00H
03FA D23A            740                     SETB TICK_1MIN
03FC 61C0            741                     AJMP ACTUALIZAR_CONT_TIMER_0
03FE 22              742                     RET
03FF                 743             PASAN_10MIN:
03FF 052F            744                     INC CONT_10MIN
0401 752E00          745                     MOV CONT_1MIN, #00H
0404 D23C            746                     SETB TICK_10MIN
0406 61C0            747                     AJMP ACTUALIZAR_CONT_TIMER_0
0408 22              748                     RET
0409                 749             PASAN_50MIN:
0409 D23B            750                     SETB TICK_50MIN
040B 752F00          751                     MOV CONT_10MIN, #00H
040E 22              752                     RET
                     753     
                     754     
                     755     
                     756             ;SI CONT_INT_TO = 31 ENTONCES tick_1s
                     757             ;si tick_1s inc cont 1s
                     758             ;si cont1_1s = 15 ENTONCES tick_15s
                     759             ;si tick 15s inc cont_15s
                     760             ;si cont_15s = 4 entonces tick_1min
                     761             ;si tick_1min inc cont_1min
                     762             ;si cont_1min = 10 ENTONCES tick_10min
                     763             ;si tick_10min inc cont_10min
                     764             ;si cont_10min = 5 ENTONCES tick_50min
                     765     
                     766     
040F 22              767             RET
0410                 768     APAGAR_TIMER:
0410 22              769             RET
                     770     
0411                 771     ACTIVAR_PWM0_60RPM:
0411 75FC1A          772             MOV PWM0, #0x1A
0414 22              773             RET
                     774     
0415                 775     ACTIVAR_PWM0_600RPM:
0415 75FCE6          776             MOV PWM0, #0xE6
0418 22              777             RET
                     778     
0419                 779     APAGAR_PWM0:
0419 8500FC          780             MOV PWM0, 0x00
041C 22              781             RET
                     782     
041D                 783     CARGAR_DISPLAY_1:
041D 7480            784             MOV A, #0x80
041F 5280            785             ANL P0, A               ; 1000 0000 -> nos settea todo a 0 menos el .7
0421 E525            786             MOV A, DISPLAY_1
0423 4280            787             ORL P0, A               ; dsp1 siempre tiene un 0 en .7 por ello no modifica p0.7
                     788     
0425 22              789             RET
                     790     
0426                 791     CARGAR_DISPLAY_0:
0426 7480            792             MOV A, #0x80
0428 52A0            793             ANL P2, A               ; 1000 0000 -> nos settea todo a 0 menos el .7
042A E526            794             MOV A, DISPLAY_0
042C 42A0            795             ORL P2, A               ; dsp1 siempre tiene un 0 en .7 por ello no modifica p0.7
042E 22              796             RET
                     797     
                     798     
042F                 799     SET_TEMP_SELECT:
042F 20B103          800             JB P3.1, SET_T_ALTAS
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    14

0432 813B            801             AJMP SET_T_BAJAS
0434 22              802             RET
                     803             
0435                 804             SET_T_ALTAS:
0435 20B007          805                     JB P3.0, SET_T_T3
0438 8143            806                     AJMP SET_T_T2
043A 22              807                     RET
043B                 808             SET_T_BAJAS:
043B 20B009          809                     JB P3.0, SET_T_T1
043E 22              810                     RET
                     811     
043F                 812                     SET_T_T3:
043F 752ACD          813                             MOV TEMP_SEL, #0xCD
0442 22              814                             RET
0443                 815                     SET_T_T2:
0443 752A9A          816                             MOV TEMP_SEL, #0x9A
0446 22              817                             RET
0447                 818                     SET_T_T1:
0447 752A66          819                             MOV TEMP_SEL, #0x66
044A 22              820                             RET
                     821             
044B                 822     CARGAR_TEMP_DSP_0:
044B 30B103          823             JNB BIT1_TEMP, COMPROBAR_B0T_B1_0
044E 8157            824             AJMP COMPROBAR_B0T_B1_1
0450 22              825             RET
                     826     
0451                 827             COMPROBAR_B0T_B1_0:
0451 20B00D          828                     JB BIT0_TEMP, PINTAR_D0_T1
0454 815D            829                     AJMP PINTAR_D0_T0
0456 22              830                     RET
0457                 831             COMPROBAR_B0T_B1_1:
0457 20B00F          832                     JB BIT0_TEMP, PINTAR_D0_T3
045A 8165            833                     AJMP PINTAR_D0_T2
045C 22              834                     RET
                     835             
045D                 836             PINTAR_D0_T0:
045D 75263F          837                     MOV DISPLAY_0, #0x3F    ;0
0460 22              838                     RET
0461                 839             PINTAR_D0_T1:
0461 752606          840                     MOV DISPLAY_0, #0x06    ;1
0464 22              841                     RET
0465                 842             PINTAR_D0_T2:
0465 75265B          843                     MOV DISPLAY_0, #0x5B    ;2
0468 22              844                     RET
0469                 845             PINTAR_D0_T3:
0469 75264F          846                     MOV DISPLAY_0, #0x4F    ;3
046C 22              847                     RET
                     848     
046D                 849     MAPEAR_TIEMPO_D1_D0:                    ;guardamos los valores de t restante por decenas y 
                             unidades en dos dir.
046D E522            850             MOV A,TIEMPO_RESTANTE_MINS
046F 75F00A          851             MOV B, #0AH
0472 84              852             DIV AB                          ; APROVECHAMOS QUE ADCH/10 COCIENTE -> A (decenas) 
                             Y RESTO -> B (unidades)
0473 F528            853             MOV DECENAS, A
0475 85F029          854             MOV UNIDADES, B
                     855             
0478 917D            856             ACALL MAP_DEC_D1
047A 91C0            857             ACALL MAP_UNI_D0
                     858     
047C 22              859             RET
                     860     
047D                 861             MAP_DEC_D1:
047D E528            862                     MOV A, DECENAS
047F 23              863                     RL A
0480 900484          864                     MOV DPTR, #LISTA_DECENAS
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    15

0483 73              865                     JMP @A+DPTR
0484                 866             LISTA_DECENAS:
0484 8198            867                     AJMP CD0
0486 819C            868                     AJMP CD1
0488 81A0            869                     AJMP CD2
048A 81A4            870                     AJMP CD3
048C 81A8            871                     AJMP CD4
048E 81AC            872                     AJMP CD5
0490 81B0            873                     AJMP CD6
0492 81B4            874                     AJMP CD7
0494 81B8            875                     AJMP CD8
0496 81BC            876                     AJMP CD9
                     877             
0498                 878             CD0:
0498 75253F          879                     MOV DISPLAY_1, #0x3F
049B 22              880                     RET
049C                 881             CD1:
049C 752506          882                     MOV DISPLAY_1, #0x06
049F 22              883                     RET
04A0                 884             CD2:
04A0 75255B          885                     MOV DISPLAY_1, #0x5B
04A3 22              886                     RET
04A4                 887             CD3:
04A4 75254F          888                     MOV DISPLAY_1, #0x4F
04A7 22              889                     RET
04A8                 890             CD4:
04A8 752566          891                     MOV DISPLAY_1, #0x66
04AB 22              892                     RET
04AC                 893             CD5:
04AC 75256D          894                     MOV DISPLAY_1, #0x6D
04AF 22              895                     RET
04B0                 896             CD6:
04B0 75257D          897                     MOV DISPLAY_1, #0x7D
04B3 22              898                     RET
04B4                 899             CD7:
04B4 752507          900                     MOV DISPLAY_1, #0x07
04B7 22              901                     RET
04B8                 902             CD8:
04B8 75257F          903                     MOV DISPLAY_1, #0x7F
04BB 22              904                     RET
04BC                 905             CD9:
04BC 75256F          906                     MOV DISPLAY_1, #0x6F
04BF 22              907                     RET
                     908     
04C0                 909             MAP_UNI_D0:
04C0 E529            910                     MOV A, UNIDADES
04C2 23              911                     RL A
04C3 9004C7          912                     MOV DPTR, #LISTA_UNIDADES
04C6 73              913                     JMP @A+DPTR
04C7                 914             LISTA_UNIDADES:
04C7 81DB            915                     AJMP CU0
04C9 81DF            916                     AJMP CU1
04CB 81E3            917                     AJMP CU2
04CD 81E7            918                     AJMP CU3
04CF 81EB            919                     AJMP CU4
04D1 81EF            920                     AJMP CU5
04D3 81F3            921                     AJMP CU6
04D5 81F7            922                     AJMP CU7
04D7 81FB            923                     AJMP CU8
04D9 81FF            924                     AJMP CU9
                     925             
04DB                 926             CU0:
04DB 75263F          927                     MOV DISPLAY_0, #0x3F
04DE 22              928                     RET
04DF                 929             CU1:
04DF 752606          930                     MOV DISPLAY_0, #0x06
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    16

04E2 22              931                     RET
04E3                 932             CU2:
04E3 75265B          933                     MOV DISPLAY_0, #0x5B
04E6 22              934                     RET
04E7                 935             CU3:
04E7 75264F          936                     MOV DISPLAY_0, #0x4F
04EA 22              937                     RET
04EB                 938             CU4:
04EB 752666          939                     MOV DISPLAY_0, #0x66
04EE 22              940                     RET
04EF                 941             CU5:
04EF 75266D          942                     MOV DISPLAY_0, #0x6D
04F2 22              943                     RET
04F3                 944             CU6:
04F3 75267D          945                     MOV DISPLAY_0, #0x7D
04F6 22              946                     RET
04F7                 947             CU7:
04F7 752607          948                     MOV DISPLAY_0, #0x07
04FA 22              949                     RET
04FB                 950             CU8:
04FB 75267F          951                     MOV DISPLAY_0, #0x7F
04FE 22              952                     RET
04FF                 953             CU9:
04FF 75266F          954                     MOV DISPLAY_0, #0x6F
0502 22              955                     RET
                     956     
0503                 957     CAMBIAR_SENTIDO_GIRO:
0503 20A703          958             JB SENTIDO_GIRO_MOTOR, FALSE_SG                 ;SI SENT 1 -> VAMOS A SET0
0506 A10C            959             AJMP TRUE_SG                                    ;SI SENT 0 -> SET1
0508 22              960             RET
0509                 961             FALSE_SG:
0509 C2A7            962                     CLR SENTIDO_GIRO_MOTOR
050B 22              963                     RET
050C                 964             TRUE_SG:
050C D2A7            965                     SETB SENTIDO_GIRO_MOTOR
050E 22              966                     RET
                     967     ;==============================================INTERRUPCIONES==============================
                             =========================
                     968     
050F                 969     INT0_ISR:
050F C0E0            970             PUSH ACC
0511 C0D0            971             PUSH PSW
0513 D218            972             SETB TICK_INT_0
0515 C2A8            973             CLR IE.0
0517 D0D0            974             POP PSW
0519 D0E0            975             POP ACC
051B 32              976             RETI
                     977     
051C                 978     ADC_ISR:
051C C0E0            979             PUSH ACC
051E C0D0            980             PUSH PSW
0520 D219            981             SETB TICK_ADC
0522 85C630          982             MOV VALOR_ADC, ADCH
0525 53C5E1          983             ANL ADCON, #0xE1                ;PARAS EL ADC
0528 D0D0            984             POP PSW
052A D0E0            985             POP ACC
052C 32              986             RETI
                     987     
052D                 988     TIMER_0_ISR:
052D C0E0            989             PUSH ACC
052F C0D0            990             PUSH PSW
0531 052B            991             INC CONT_INTERRUPCIONES_T0
0533 71C0            992             ACALL ACTUALIZAR_CONT_TIMER_0
0535 7198            993             ACALL ACTIVAR_TIMER_0
0537 D0D0            994             POP PSW
0539 D0E0            995             POP ACC
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    17

053B 32              996             RETI
                     997     
                     998     ;==============================================FIN=========================================
                             =============
                     999     
                    1000     END
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    18

SYMBOL TABLE LISTING
------ ----- -------


N A M E                         T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACTIVAR_ADC_PESO . . . . . . .  C ADDR   0382H   A   
ACTIVAR_ADC_TEMP . . . . . . .  C ADDR   0389H   A   
ACTIVAR_PWM0_600RPM. . . . . .  C ADDR   0415H   A   
ACTIVAR_PWM0_60RPM . . . . . .  C ADDR   0411H   A   
ACTIVAR_TIMER_0. . . . . . . .  C ADDR   0398H   A   
ACTIVAR_TIMER_0_FULL . . . . .  C ADDR   03B0H   A   
ACTIVAR_TIMER_0_PRIMERA_VUELTA  C ADDR   039EH   A   
ACTUALIZAR_CONT_TIMER_0. . . .  C ADDR   03C0H   A   
ADCH . . . . . . . . . . . . .  N NUMB   00C6H   A   
ADCON. . . . . . . . . . . . .  N NUMB   00C5H   A   
ADC_ISR. . . . . . . . . . . .  C ADDR   051CH   A   
APAGAR_ADC . . . . . . . . . .  C ADDR   0392H   A   
APAGAR_PWM0. . . . . . . . . .  C ADDR   0419H   A   
APAGAR_TIMER . . . . . . . . .  C ADDR   0410H   A   
B. . . . . . . . . . . . . . .  D ADDR   00F0H   A   
BIT0_TEMP. . . . . . . . . . .  B ADDR   00B0H.0 A   
BIT1_TEMP. . . . . . . . . . .  B ADDR   00B0H.1 A   
BLOQUEO_PUERTA . . . . . . . .  B ADDR   0080H.7 A   
BOTON_INICIO . . . . . . . . .  B ADDR   0090H.4 A   
CALENTADOR_AGUA. . . . . . . .  B ADDR   00B0H.6 A   
CAMBIAR_SENTIDO_GIRO . . . . .  C ADDR   0503H   A   
CARGAR_DISPLAY_0 . . . . . . .  C ADDR   0426H   A   
CARGAR_DISPLAY_1 . . . . . . .  C ADDR   041DH   A   
CARGAR_TEMP_DSP_0. . . . . . .  C ADDR   044BH   A   
CD0. . . . . . . . . . . . . .  C ADDR   0498H   A   
CD1. . . . . . . . . . . . . .  C ADDR   049CH   A   
CD2. . . . . . . . . . . . . .  C ADDR   04A0H   A   
CD3. . . . . . . . . . . . . .  C ADDR   04A4H   A   
CD4. . . . . . . . . . . . . .  C ADDR   04A8H   A   
CD5. . . . . . . . . . . . . .  C ADDR   04ACH   A   
CD6. . . . . . . . . . . . . .  C ADDR   04B0H   A   
CD7. . . . . . . . . . . . . .  C ADDR   04B4H   A   
CD8. . . . . . . . . . . . . .  C ADDR   04B8H   A   
CD9. . . . . . . . . . . . . .  C ADDR   04BCH   A   
COMPROBAR_B0T_B1_0 . . . . . .  C ADDR   0451H   A   
COMPROBAR_B0T_B1_1 . . . . . .  C ADDR   0457H   A   
COMPROBAR_BTN_INICIO . . . . .  C ADDR   02B4H   A   
COMPROBAR_PUERTA . . . . . . .  C ADDR   0294H   A   
COMPROBAR_TEMP . . . . . . . .  C ADDR   030FH   A   
COMP_T3_T2_T1. . . . . . . . .  C ADDR   0318H   A   
COMP_TICK_ADC. . . . . . . . .  C ADDR   0308H   A   
CONT_10MIN . . . . . . . . . .  N NUMB   002FH   A   
CONT_15S . . . . . . . . . . .  N NUMB   002DH   A   
CONT_1MIN. . . . . . . . . . .  N NUMB   002EH   A   
CONT_1S. . . . . . . . . . . .  N NUMB   002CH   A   
CONT_INTERRUPCIONES_T0 . . . .  N NUMB   002BH   A   
CU0. . . . . . . . . . . . . .  C ADDR   04DBH   A   
CU1. . . . . . . . . . . . . .  C ADDR   04DFH   A   
CU2. . . . . . . . . . . . . .  C ADDR   04E3H   A   
CU3. . . . . . . . . . . . . .  C ADDR   04E7H   A   
CU4. . . . . . . . . . . . . .  C ADDR   04EBH   A   
CU5. . . . . . . . . . . . . .  C ADDR   04EFH   A   
CU6. . . . . . . . . . . . . .  C ADDR   04F3H   A   
CU7. . . . . . . . . . . . . .  C ADDR   04F7H   A   
CU8. . . . . . . . . . . . . .  C ADDR   04FBH   A   
CU9. . . . . . . . . . . . . .  C ADDR   04FFH   A   
DECENAS. . . . . . . . . . . .  N NUMB   0028H   A   
DISPLAY_0. . . . . . . . . . .  N NUMB   0026H   A   
DISPLAY_1. . . . . . . . . . .  N NUMB   0025H   A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    19

ESTADO . . . . . . . . . . . .  N NUMB   0020H   A   
ESTADO_0 . . . . . . . . . . .  C ADDR   00EBH   A   
ESTADO_1 . . . . . . . . . . .  C ADDR   00F0H   A   
ESTADO_2 . . . . . . . . . . .  C ADDR   00F5H   A   
ESTADO_3 . . . . . . . . . . .  C ADDR   00FAH   A   
ESTADO_4 . . . . . . . . . . .  C ADDR   00FFH   A   
ESTADO_5 . . . . . . . . . . .  C ADDR   0104H   A   
ESTADO_6 . . . . . . . . . . .  C ADDR   0109H   A   
ESTADO_7 . . . . . . . . . . .  C ADDR   010EH   A   
ESTADO_8 . . . . . . . . . . .  C ADDR   0113H   A   
EVENTO . . . . . . . . . . . .  N NUMB   0021H   A   
FALSE_SG . . . . . . . . . . .  C ADDR   0509H   A   
GEN_EV_0 . . . . . . . . . . .  C ADDR   028DH   A   
GEN_EV_1 . . . . . . . . . . .  C ADDR   02A7H   A   
GEN_EV_1_ES_0. . . . . . . . .  C ADDR   0299H   A   
GEN_EV_1_ES_1. . . . . . . . .  C ADDR   02BBH   A   
GEN_EV_1_ES_2. . . . . . . . .  C ADDR   02EAH   A   
GEN_EV_1_ES_3. . . . . . . . .  C ADDR   02F5H   A   
GEN_EV_1_ES_4. . . . . . . . .  C ADDR   0321H   A   
GEN_EV_1_ES_5. . . . . . . . .  C ADDR   033EH   A   
GEN_EV_1_ES_6. . . . . . . . .  C ADDR   035DH   A   
GEN_EV_1_ES_7. . . . . . . . .  C ADDR   036BH   A   
GEN_EV_1_ES_8. . . . . . . . .  C ADDR   037EH   A   
GEN_EV_2 . . . . . . . . . . .  C ADDR   02E3H   A   
GEN_EV_2_ES_0. . . . . . . . .  C ADDR   02A0H   A   
GEN_EV_2_ES_1. . . . . . . . .  C ADDR   02C3H   A   
GEN_EV_2_ES_4. . . . . . . . .  C ADDR   0329H   A   
GEN_EV_2_ES_5. . . . . . . . .  C ADDR   0344H   A   
GEN_EV_2_ES_7. . . . . . . . .  C ADDR   0371H   A   
GEN_EV_3 . . . . . . . . . . .  C ADDR   02EEH   A   
GEN_EV_3_ES_1. . . . . . . . .  C ADDR   02C9H   A   
GEN_EV_3_ES_5. . . . . . . . .  C ADDR   034AH   A   
GEN_EV_4 . . . . . . . . . . .  C ADDR   02F9H   A   
GEN_EV_4_ES_1. . . . . . . . .  C ADDR   02CFH   A   
GEN_EV_5 . . . . . . . . . . .  C ADDR   0331H   A   
GEN_EV_6 . . . . . . . . . . .  C ADDR   0356H   A   
GEN_EV_7 . . . . . . . . . . .  C ADDR   0361H   A   
GEN_EV_8 . . . . . . . . . . .  C ADDR   0377H   A   
HAY_SP . . . . . . . . . . . .  C ADDR   02D7H   A   
IE . . . . . . . . . . . . . .  D ADDR   00A8H   A   
INICIALIZACIONES . . . . . . .  C ADDR   009AH   A   
INICIO . . . . . . . . . . . .  C ADDR   007BH   A   
INT0_ISR . . . . . . . . . . .  C ADDR   050FH   A   
LISTA_DECENAS. . . . . . . . .  C ADDR   0484H   A   
LISTA_EST. . . . . . . . . . .  C ADDR   0088H   A   
LISTA_UNIDADES . . . . . . . .  C ADDR   04C7H   A   
LIST_EVEN_MQEV_0 . . . . . . .  C ADDR   011FH   A   
LIST_EVEN_MQEV_1 . . . . . . .  C ADDR   014EH   A   
LIST_EVEN_MQEV_2 . . . . . . .  C ADDR   019EH   A   
LIST_EVEN_MQEV_3 . . . . . . .  C ADDR   01BAH   A   
LIST_EVEN_MQEV_4 . . . . . . .  C ADDR   01D6H   A   
LIST_EVEN_MQEV_5 . . . . . . .  C ADDR   01F7H   A   
LIST_EVEN_MQEV_6 . . . . . . .  C ADDR   0235H   A   
LIST_EVEN_MQEV_7 . . . . . . .  C ADDR   0251H   A   
LIST_EVEN_MQEV_8 . . . . . . .  C ADDR   027AH   A   
MAIN . . . . . . . . . . . . .  C ADDR   007DH   A   
MAPEAR_TIEMPO_D1_D0. . . . . .  C ADDR   046DH   A   
MAP_DEC_D1 . . . . . . . . . .  C ADDR   047DH   A   
MAP_UNI_D0 . . . . . . . . . .  C ADDR   04C0H   A   
MAQ_ESTADOS. . . . . . . . . .  C ADDR   0081H   A   
ME0_EV_0 . . . . . . . . . . .  C ADDR   0125H   A   
ME0_EV_1 . . . . . . . . . . .  C ADDR   0129H   A   
ME0_EV_2 . . . . . . . . . . .  C ADDR   0139H   A   
ME1_EV_0 . . . . . . . . . . .  C ADDR   0158H   A   
ME1_EV_1 . . . . . . . . . . .  C ADDR   0159H   A   
ME1_EV_2 . . . . . . . . . . .  C ADDR   0169H   A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    20

ME1_EV_3 . . . . . . . . . . .  C ADDR   0176H   A   
ME1_EV_4 . . . . . . . . . . .  C ADDR   018BH   A   
ME2_EV_0 . . . . . . . . . . .  C ADDR   01A2H   A   
ME2_EV_1 . . . . . . . . . . .  C ADDR   01A3H   A   
ME3_EV_0 . . . . . . . . . . .  C ADDR   01BEH   A   
ME3_EV_1 . . . . . . . . . . .  C ADDR   01BFH   A   
ME4_EV_0 . . . . . . . . . . .  C ADDR   01DCH   A   
ME4_EV_1 . . . . . . . . . . .  C ADDR   01DDH   A   
ME4_EV_2 . . . . . . . . . . .  C ADDR   01E4H   A   
ME5_EV_0 . . . . . . . . . . .  C ADDR   01FFH   A   
ME5_EV_1 . . . . . . . . . . .  C ADDR   0200H   A   
ME5_EV_2 . . . . . . . . . . .  C ADDR   020DH   A   
ME5_EV_3 . . . . . . . . . . .  C ADDR   021AH   A   
ME6_EV_0 . . . . . . . . . . .  C ADDR   0239H   A   
ME6_EV_1 . . . . . . . . . . .  C ADDR   023AH   A   
ME7_EV_0 . . . . . . . . . . .  C ADDR   0257H   A   
ME7_EV_1 . . . . . . . . . . .  C ADDR   0258H   A   
ME7_EV_2 . . . . . . . . . . .  C ADDR   026AH   A   
ME8_EV_0 . . . . . . . . . . .  C ADDR   027EH   A   
ME8_EV_1 . . . . . . . . . . .  C ADDR   027FH   A   
MOTOR_DESAGUE. . . . . . . . .  B ADDR   0090H.0 A   
MQ_EVEN_0. . . . . . . . . . .  C ADDR   0118H   A   
MQ_EVEN_1. . . . . . . . . . .  C ADDR   0147H   A   
MQ_EVEN_2. . . . . . . . . . .  C ADDR   0197H   A   
MQ_EVEN_3. . . . . . . . . . .  C ADDR   01B3H   A   
MQ_EVEN_4. . . . . . . . . . .  C ADDR   01CFH   A   
MQ_EVEN_5. . . . . . . . . . .  C ADDR   01F0H   A   
MQ_EVEN_6. . . . . . . . . . .  C ADDR   022EH   A   
MQ_EVEN_7. . . . . . . . . . .  C ADDR   024AH   A   
MQ_EVEN_8. . . . . . . . . . .  C ADDR   0273H   A   
P0 . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PASAN_10MIN. . . . . . . . . .  C ADDR   03FFH   A   
PASAN_15SEG. . . . . . . . . .  C ADDR   03EBH   A   
PASAN_1MIN . . . . . . . . . .  C ADDR   03F5H   A   
PASAN_1SEG . . . . . . . . . .  C ADDR   03DFH   A   
PASAN_50MIN. . . . . . . . . .  C ADDR   0409H   A   
PCON . . . . . . . . . . . . .  D ADDR   0087H   A   
PINTAR_D0_T0 . . . . . . . . .  C ADDR   045DH   A   
PINTAR_D0_T1 . . . . . . . . .  C ADDR   0461H   A   
PINTAR_D0_T2 . . . . . . . . .  C ADDR   0465H   A   
PINTAR_D0_T3 . . . . . . . . .  C ADDR   0469H   A   
PRIMERA_VUELTA . . . . . . . .  B ADDR   0027H.5 A   
PSW. . . . . . . . . . . . . .  D ADDR   00D0H   A   
PUERTA_ABIERTA . . . . . . . .  B ADDR   0090H.1 A   
PWM0 . . . . . . . . . . . . .  N NUMB   00FCH   A   
PWMP . . . . . . . . . . . . .  N NUMB   00FEH   A   
SENSOR_LLENADO . . . . . . . .  B ADDR   0090H.2 A   
SENSOR_VACIADO . . . . . . . .  B ADDR   0090H.3 A   
SENTIDO_GIRO_MOTOR . . . . . .  B ADDR   00A0H.7 A   
SET_TEMP_SELECT. . . . . . . .  C ADDR   042FH   A   
SET_T_ALTAS. . . . . . . . . .  C ADDR   0435H   A   
SET_T_BAJAS. . . . . . . . . .  C ADDR   043BH   A   
SET_T_T1 . . . . . . . . . . .  C ADDR   0447H   A   
SET_T_T2 . . . . . . . . . . .  C ADDR   0443H   A   
SET_T_T3 . . . . . . . . . . .  C ADDR   043FH   A   
TEMP_SEL . . . . . . . . . . .  N NUMB   002AH   A   
TH0. . . . . . . . . . . . . .  D ADDR   008CH   A   
TICK_10MIN . . . . . . . . . .  B ADDR   0027H.4 A   
TICK_15S . . . . . . . . . . .  B ADDR   0027H.1 A   
TICK_1MIN. . . . . . . . . . .  B ADDR   0027H.2 A   
TICK_1S. . . . . . . . . . . .  B ADDR   0027H.0 A   
TICK_50MIN . . . . . . . . . .  B ADDR   0027H.3 A   
TICK_ADC . . . . . . . . . . .  B ADDR   0023H.1 A   
A51 MACRO ASSEMBLER  LAVADORA                                                             11/26/2025 11:06:06 PAGE    21

TICK_INT_0 . . . . . . . . . .  B ADDR   0023H.0 A   
TICK_PESADO_OK . . . . . . . .  B ADDR   0023H.4 A   
TICK_TIMER_0 . . . . . . . . .  B ADDR   0023H.3 A   
TIEMPO_RESTANTE_MINS . . . . .  N NUMB   0022H   A   
TIMER_0_ISR. . . . . . . . . .  C ADDR   052DH   A   
TL0. . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRUE_SG. . . . . . . . . . . .  C ADDR   050CH   A   
T_SEL. . . . . . . . . . . . .  C ADDR   0301H   A   
UNIDADES . . . . . . . . . . .  N NUMB   0029H   A   
VALOR_ADC. . . . . . . . . . .  N NUMB   0030H   A   
VALV_ENTRADA_AGUA. . . . . . .  B ADDR   00B0H.3 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
